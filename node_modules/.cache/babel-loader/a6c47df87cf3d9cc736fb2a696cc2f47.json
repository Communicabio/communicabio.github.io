{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction _createSuper(Derived) {\n  return function () {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (_isNativeReflectConstruct()) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport React from 'react';\nimport classNames from '../../lib/classNames';\nimport Icon24Dropdown from '@vkontakte/icons/dist/24/dropdown';\nimport FormField from '../FormField/FormField';\n\nvar Select = /*#__PURE__*/function (_React$Component) {\n  _inherits(Select, _React$Component);\n\n  var _super = _createSuper(Select);\n\n  function Select(props) {\n    var _this;\n\n    _classCallCheck(this, Select);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"isControlledOutside\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"selectEl\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"onChange\", function (e) {\n      _this.setTitle();\n\n      if (!_this.isControlledOutside) {\n        _this.setState({\n          value: e.currentTarget.value\n        });\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(e);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setTitle\", function () {\n      var selectedOption = _this.selectEl.options[_this.selectEl.selectedIndex];\n      selectedOption && _this.setState({\n        title: selectedOption.text,\n        notSelected: selectedOption.value === '' && _this.props.hasOwnProperty('placeholder')\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getRef\", function (element) {\n      _this.selectEl = element;\n      var getRef = _this.props.getRef;\n\n      if (getRef) {\n        if (typeof getRef === 'function') {\n          getRef(element);\n        } else {\n          getRef.current = element;\n        }\n      }\n    });\n\n    var state = {\n      title: '',\n      notSelected: false\n    };\n\n    if (typeof props.value !== 'undefined') {\n      _this.isControlledOutside = true;\n    } else {\n      state.value = props.defaultValue || '';\n    }\n\n    _this.state = state;\n    return _this;\n  }\n\n  _createClass(Select, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.value !== this.props.value || prevProps.children !== this.props.children) {\n        this.setTitle();\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setTitle();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _classNames;\n\n      var _this$props = this.props,\n          style = _this$props.style,\n          value = _this$props.value,\n          defaultValue = _this$props.defaultValue,\n          onChange = _this$props.onChange,\n          align = _this$props.align,\n          status = _this$props.status,\n          placeholder = _this$props.placeholder,\n          children = _this$props.children,\n          className = _this$props.className,\n          getRef = _this$props.getRef,\n          getRootRef = _this$props.getRootRef,\n          top = _this$props.top,\n          bottom = _this$props.bottom,\n          disabled = _this$props.disabled,\n          restProps = _objectWithoutProperties(_this$props, [\"style\", \"value\", \"defaultValue\", \"onChange\", \"align\", \"status\", \"placeholder\", \"children\", \"className\", \"getRef\", \"getRootRef\", \"top\", \"bottom\", \"disabled\"]);\n\n      return /*#__PURE__*/React.createElement(FormField, {\n        Component: \"label\",\n        className: classNames('Select', (_classNames = {}, _defineProperty(_classNames, 'Select--not-selected', this.state.notSelected), _defineProperty(_classNames, \"Select--align-\".concat(align), !!align), _defineProperty(_classNames, 'Select--disabled', disabled), _classNames), className),\n        style: style,\n        getRootRef: getRootRef,\n        status: status\n      }, /*#__PURE__*/React.createElement(\"select\", _extends({}, restProps, {\n        disabled: disabled,\n        className: \"Select__el\",\n        onChange: this.onChange,\n        value: this.value,\n        ref: this.getRef\n      }), placeholder && /*#__PURE__*/React.createElement(\"option\", {\n        value: \"\"\n      }, placeholder), children), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Select__container\"\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"Select__title\"\n      }, this.state.title), /*#__PURE__*/React.createElement(Icon24Dropdown, null)));\n    }\n  }, {\n    key: \"value\",\n    get: function get() {\n      return this.isControlledOutside ? this.props.value : this.state.value;\n    }\n  }]);\n\n  return Select;\n}(React.Component);\n\nexport { Select as default };","map":{"version":3,"sources":["../../../../src/components/Select/Select.tsx"],"names":["Select","React","Component","state","title","notSelected","props","value","e","selectedOption","prevProps","getRef","style","defaultValue","onChange","align","status","placeholder","children","className","getRootRef","top","bottom","disabled","restProps","classNames"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, ChangeEventHandler, SelectHTMLAttributes } from 'react';\nimport classNames from '../../lib/classNames';\nimport Icon24Dropdown from '@vkontakte/icons/dist/24/dropdown';\nimport FormField from '../FormField/FormField';\nimport { HasAlign, HasFormLabels, HasFormStatus, HasRef, HasRootRef, OldRef } from '../../types';\n\nexport interface SelectProps extends\n  SelectHTMLAttributes<HTMLSelectElement>,\n  HasRef<HTMLSelectElement>,\n  HasRootRef<HTMLLabelElement>,\n  HasFormStatus,\n  HasFormLabels,\n  HasAlign {\n  defaultValue?: string;\n  placeholder?: string;\n}\n\nexport interface SelectState {\n  value?: string;\n  title?: string;\n  notSelected?: boolean;\n}\n\nexport default class Select extends React.Component<SelectProps, SelectState> {\n  constructor(props: SelectProps) {\n    super(props);\n    const state: SelectState = {\n      title: '',\n      notSelected: false,\n    };\n    if (typeof props.value !== 'undefined') {\n      this.isControlledOutside = true;\n    } else {\n      state.value = props.defaultValue || '';\n    }\n    this.state = state;\n  }\n\n  isControlledOutside?: boolean;\n  selectEl?: HTMLSelectElement;\n\n  onChange: ChangeEventHandler = (e: ChangeEvent<HTMLSelectElement>) => {\n    this.setTitle();\n    if (!this.isControlledOutside) {\n      this.setState({ value: e.currentTarget.value });\n    }\n    if (this.props.onChange) {\n      this.props.onChange(e);\n    }\n  };\n\n  setTitle: VoidFunction = () => {\n    const selectedOption = this.selectEl.options[this.selectEl.selectedIndex];\n    selectedOption && this.setState({\n      title: selectedOption.text,\n      notSelected: selectedOption.value === '' && this.props.hasOwnProperty('placeholder'),\n    });\n  };\n\n  componentDidUpdate(prevProps: SelectProps) {\n    if (prevProps.value !== this.props.value || prevProps.children !== this.props.children) {\n      this.setTitle();\n    }\n  }\n\n  componentDidMount() {\n    this.setTitle();\n  }\n\n  get value() {\n    return this.isControlledOutside ? this.props.value : this.state.value;\n  }\n\n  getRef: OldRef<HTMLSelectElement> = (element: HTMLSelectElement) => {\n    this.selectEl = element;\n\n    const getRef = this.props.getRef;\n    if (getRef) {\n      if (typeof getRef === 'function') {\n        getRef(element);\n      } else {\n        getRef.current = element;\n      }\n    }\n  };\n\n  render() {\n    const { style, value, defaultValue, onChange, align, status, placeholder, children, className,\n      getRef, getRootRef, top, bottom, disabled, ...restProps } = this.props;\n\n    return (\n      <FormField\n        Component=\"label\"\n        className={classNames('Select', {\n          ['Select--not-selected']: this.state.notSelected,\n          [`Select--align-${align}`]: !!align,\n          'Select--disabled': disabled,\n        }, className)}\n        style={style}\n        getRootRef={getRootRef}\n        status={status}\n      >\n        <select\n          {...restProps}\n          disabled={disabled}\n          className=\"Select__el\"\n          onChange={this.onChange}\n          value={this.value}\n          ref={this.getRef}\n        >\n          {placeholder && <option value=\"\">{placeholder}</option>}\n          {children}\n        </select>\n        <div className=\"Select__container\">\n          <div className=\"Select__title\">{this.state.title}</div>\n          <Icon24Dropdown />\n        </div>\n      </FormField>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}