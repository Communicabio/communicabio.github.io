{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime/helpers/assertThisInitialized\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _getClassName = _interopRequireDefault(require(\"../../helpers/getClassName\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _classNames = _interopRequireDefault(require(\"../../lib/classNames\"));\n\nvar _View = require(\"../View/View\");\n\nvar _constants = require(\"../../appearance/constants\");\n\nvar _withInsets = _interopRequireDefault(require(\"../../hoc/withInsets\"));\n\nvar _utils = require(\"../../lib/utils\");\n\nvar _withPlatform = _interopRequireDefault(require(\"../../hoc/withPlatform\"));\n\nvar _withPanelContext = _interopRequireDefault(require(\"../Panel/withPanelContext\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _createSuper(Derived) {\n  return function () {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (_isNativeReflectConstruct()) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar FixedLayout = /*#__PURE__*/function (_React$Component) {\n  (0, _inherits2.default)(FixedLayout, _React$Component);\n\n  var _super = _createSuper(FixedLayout);\n\n  function FixedLayout() {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, FixedLayout);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"state\", {\n      position: null,\n      top: null\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"el\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"onViewTransitionStart\", function (e) {\n      var panelScroll = e.detail.scrolls[_this.props.panel] || 0;\n\n      _this.setState({\n        position: 'absolute',\n        top: _this.el.offsetTop + panelScroll\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"onViewTransitionEnd\", function () {\n      _this.setState({\n        position: null,\n        top: null\n      });\n    });\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"getRef\", function (element) {\n      _this.el = element;\n      var getRootRef = _this.props.getRootRef;\n\n      if (getRootRef) {\n        if (typeof getRootRef === 'function') {\n          getRootRef(element);\n        } else {\n          getRootRef.current = element;\n        }\n      }\n    });\n    return _this;\n  }\n\n  (0, _createClass2.default)(FixedLayout, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.document.addEventListener(_View.transitionStartEventName, this.onViewTransitionStart);\n      this.document.addEventListener(_View.transitionEndEventName, this.onViewTransitionEnd);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.document.removeEventListener(_View.transitionStartEventName, this.onViewTransitionStart);\n      this.document.removeEventListener(_View.transitionEndEventName, this.onViewTransitionEnd);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          className = _this$props.className,\n          children = _this$props.children,\n          style = _this$props.style,\n          vertical = _this$props.vertical,\n          getRootRef = _this$props.getRootRef,\n          insets = _this$props.insets,\n          platform = _this$props.platform,\n          filled = _this$props.filled,\n          separator = _this$props.separator,\n          restProps = (0, _objectWithoutProperties2.default)(_this$props, [\"className\", \"children\", \"style\", \"vertical\", \"getRootRef\", \"insets\", \"platform\", \"filled\", \"separator\"]);\n      var tabbarPadding = this.context.hasTabbar ? _constants.tabbarHeight : 0;\n      var paddingBottom = vertical === 'bottom' && (0, _utils.isNumeric)(insets.bottom) ? insets.bottom + tabbarPadding : null;\n      return /*#__PURE__*/_react.default.createElement(\"div\", (0, _extends2.default)({}, restProps, {\n        ref: this.getRef,\n        className: (0, _classNames.default)((0, _getClassName.default)('FixedLayout', platform), {\n          'FixedLayout--filled': filled\n        }, \"FixedLayout--\".concat(vertical), className),\n        style: _objectSpread({}, style, {}, this.state, {\n          paddingBottom: paddingBottom\n        })\n      }), /*#__PURE__*/_react.default.createElement(\"div\", {\n        className: \"FixedLayout__in\"\n      }, children));\n    }\n  }, {\n    key: \"document\",\n    get: function get() {\n      return this.context.document || document;\n    }\n  }]);\n  return FixedLayout;\n}(_react.default.Component);\n\n(0, _defineProperty2.default)(FixedLayout, \"contextTypes\", {\n  document: _propTypes.default.any,\n  hasTabbar: _propTypes.default.bool\n});\n\nvar _default = (0, _withPlatform.default)((0, _withInsets.default)((0, _withPanelContext.default)(FixedLayout)));\n\nexports.default = _default;","map":{"version":3,"sources":["../../../src/components/FixedLayout/FixedLayout.tsx"],"names":["FixedLayout","React","Component","position","top","document","PropTypes","hasTabbar","bool","transitionStartEventName","transitionEndEventName","panelScroll","e","getRootRef","className","children","style","vertical","insets","platform","filled","separator","restProps","tabbarPadding","tabbarHeight","paddingBottom"],"mappings":"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","sourcesContent":["import React, { HTMLAttributes } from 'react';\nimport getClassName from '../../helpers/getClassName';\nimport PropTypes, { Requireable } from 'prop-types';\nimport classNames from '../../lib/classNames';\nimport { transitionEndEventName, TransitionStartEventDetail, transitionStartEventName } from '../View/View';\nimport { tabbarHeight } from '../../appearance/constants';\nimport withInsets from '../../hoc/withInsets';\nimport { isNumeric } from '../../lib/utils';\nimport { HasInsets, HasPlatform, HasRootRef, OldRef } from '../../types';\nimport withPlatform from '../../hoc/withPlatform';\nimport withPanelContext from '../Panel/withPanelContext';\n\nexport interface FixedLayoutProps extends\n  HTMLAttributes<HTMLDivElement>,\n  HasRootRef<HTMLDivElement>,\n  HasInsets,\n  HasPlatform {\n  vertical?: 'top' | 'bottom';\n  /**\n   * Это свойство определяет, будет ли фон компонента окрашен в цвет фона контента.\n   * Это часто необходимо для фиксированных кнопок в нижней части экрана.\n   */\n  filled?: boolean;\n  /**\n   * @ignore\n   */\n  panel?: string;\n  /**\n   * @ignore\n   */\n  separator?: boolean;\n}\n\nexport interface FixedLayoutState {\n  position: 'absolute' | null;\n  top: number;\n}\n\nexport interface FixedLayoutContext {\n  document: Requireable<{}>;\n  hasTabbar: Requireable<boolean>;\n}\n\nclass FixedLayout extends React.Component<FixedLayoutProps, FixedLayoutState> {\n  state: FixedLayoutState = {\n    position: null,\n    top: null,\n  };\n\n  el: HTMLDivElement;\n\n  static contextTypes: FixedLayoutContext = {\n    document: PropTypes.any,\n    hasTabbar: PropTypes.bool,\n  };\n\n  get document() {\n    return this.context.document || document;\n  }\n\n  componentDidMount() {\n    this.document.addEventListener(transitionStartEventName, this.onViewTransitionStart);\n    this.document.addEventListener(transitionEndEventName, this.onViewTransitionEnd);\n  }\n\n  componentWillUnmount() {\n    this.document.removeEventListener(transitionStartEventName, this.onViewTransitionStart);\n    this.document.removeEventListener(transitionEndEventName, this.onViewTransitionEnd);\n  }\n\n  onViewTransitionStart: EventListener = (e: CustomEvent<TransitionStartEventDetail>) => {\n    let panelScroll = e.detail.scrolls[this.props.panel] || 0;\n    this.setState({\n      position: 'absolute',\n      top: this.el.offsetTop + panelScroll,\n    });\n  };\n\n  onViewTransitionEnd: VoidFunction = () => {\n    this.setState({\n      position: null,\n      top: null,\n    });\n  };\n\n  getRef: OldRef<HTMLDivElement> = (element: HTMLDivElement) => {\n    this.el = element;\n\n    const getRootRef = this.props.getRootRef;\n    if (getRootRef) {\n      if (typeof getRootRef === 'function') {\n        getRootRef(element);\n      } else {\n        getRootRef.current = element;\n      }\n    }\n  };\n\n  render() {\n    const { className, children, style, vertical, getRootRef, insets, platform, filled, separator, ...restProps } = this.props;\n    const tabbarPadding = this.context.hasTabbar ? tabbarHeight : 0;\n    const paddingBottom = vertical === 'bottom' && isNumeric(insets.bottom) ? insets.bottom + tabbarPadding : null;\n\n    return (\n      <div\n        {...restProps}\n        ref={this.getRef}\n        className={classNames(getClassName('FixedLayout', platform), {\n          'FixedLayout--filled': filled,\n        }, `FixedLayout--${vertical}`, className)}\n        style={{ ...style, ...this.state, paddingBottom }}\n      >\n        <div className=\"FixedLayout__in\">{children}</div>\n      </div>\n    );\n  }\n}\n\nexport default withPlatform(withInsets(withPanelContext(FixedLayout)));\n"]},"metadata":{},"sourceType":"script"}