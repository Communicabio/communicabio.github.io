{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nfunction _createSuper(Derived) {\n  return function () {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (_isNativeReflectConstruct()) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport React, { Children, Component } from 'react';\nimport PopoutWrapper from '../PopoutWrapper/PopoutWrapper';\nimport getClassName from '../../helpers/getClassName';\nimport classNames from '../../lib/classNames';\nimport transitionEvents from '../../lib/transitionEvents';\nimport withInsets from '../../hoc/withInsets';\nimport withPlatform from '../../hoc/withPlatform';\nimport { isNumeric } from '../../lib/utils';\nimport { ANDROID, IOS } from '../../lib/platform';\n\nvar ActionSheet = /*#__PURE__*/function (_Component) {\n  _inherits(ActionSheet, _Component);\n\n  var _super = _createSuper(ActionSheet);\n\n  function ActionSheet(props) {\n    var _this;\n\n    _classCallCheck(this, ActionSheet);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      closing: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"elRef\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"onClose\", function () {\n      _this.setState({\n        closing: true\n      });\n\n      _this.waitTransitionFinish(_this.props.onClose);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onItemClick\", function (action, autoclose) {\n      return function (event) {\n        event.persist();\n\n        if (autoclose) {\n          _this.setState({\n            closing: true\n          });\n\n          _this.waitTransitionFinish(function () {\n            autoclose && _this.props.onClose();\n            action && action(event);\n          });\n        } else {\n          action && action(event);\n        }\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"stopPropagation\", function (e) {\n      return e.stopPropagation();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isItemLast\", function (index) {\n      var childrenArray = Children.toArray(_this.props.children);\n      var lastElement = childrenArray[childrenArray.length - 1];\n\n      if (index === childrenArray.length - 1) {\n        return true;\n      } else if (index === childrenArray.length - 2 && lastElement.props.mode === 'cancel') {\n        return true;\n      }\n\n      return false;\n    });\n\n    _this.elRef = React.createRef();\n    return _this;\n  }\n\n  _createClass(ActionSheet, [{\n    key: \"waitTransitionFinish\",\n    value: function waitTransitionFinish(eventHandler) {\n      if (transitionEvents.supported) {\n        var eventName = transitionEvents.prefix ? transitionEvents.prefix + 'TransitionEnd' : 'transitionend';\n        this.elRef.current.removeEventListener(eventName, eventHandler);\n        this.elRef.current.addEventListener(eventName, eventHandler);\n      } else {\n        setTimeout(eventHandler, this.props.platform === ANDROID ? 200 : 300);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          children = _this$props.children,\n          className = _this$props.className,\n          header = _this$props.header,\n          text = _this$props.text,\n          style = _this$props.style,\n          insets = _this$props.insets,\n          platform = _this$props.platform,\n          restProps = _objectWithoutProperties(_this$props, [\"children\", \"className\", \"header\", \"text\", \"style\", \"insets\", \"platform\"]);\n\n      return /*#__PURE__*/React.createElement(PopoutWrapper, {\n        closing: this.state.closing,\n        alignY: \"bottom\",\n        className: className,\n        style: style,\n        onClick: this.onClose\n      }, /*#__PURE__*/React.createElement(\"div\", _extends({}, restProps, {\n        ref: this.elRef,\n        onClick: this.stopPropagation,\n        className: classNames(getClassName('ActionSheet', platform), {\n          'ActionSheet--closing': this.state.closing\n        })\n      }), platform === IOS && /*#__PURE__*/React.createElement(\"header\", {\n        className: \"ActionSheet__header\"\n      }, header && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ActionSheet__title\"\n      }, header), text && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"ActionSheet__text\"\n      }, text)), Children.toArray(children).map(function (child, index, arr) {\n        return child && React.cloneElement(child, {\n          onClick: _this2.onItemClick(child.props.onClick, child.props.autoclose),\n          style: index === arr.length - 1 && isNumeric(insets.bottom) ? {\n            marginBottom: insets.bottom\n          } : null,\n          isLast: _this2.isItemLast(index)\n        });\n      })));\n    }\n  }]);\n\n  return ActionSheet;\n}(Component);\n\nexport default withPlatform(withInsets(ActionSheet));","map":{"version":3,"sources":["../../../../src/components/ActionSheet/ActionSheet.tsx"],"names":["ActionSheet","Component","React","closing","event","autoclose","action","e","eventHandler","transitionEvents","eventName","setTimeout","childrenArray","Children","lastElement","index","children","className","header","text","style","insets","platform","restProps","onClose","classNames","getClassName","child","onClick","arr","isNumeric","marginBottom","bottom","isLast","withPlatform","withInsets"],"mappings":"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","sourcesContent":["import React, { Children, Component, HTMLAttributes, ReactElement } from 'react';\nimport PopoutWrapper from '../PopoutWrapper/PopoutWrapper';\nimport getClassName from '../../helpers/getClassName';\nimport classNames from '../../lib/classNames';\nimport transitionEvents from '../../lib/transitionEvents';\nimport withInsets from '../../hoc/withInsets';\nimport withPlatform from '../../hoc/withPlatform';\nimport { isNumeric } from '../../lib/utils';\nimport { HasInsets, HasPlatform } from '../../types';\nimport { ANDROID, IOS } from '../../lib/platform';\n\nexport interface ActionSheetProps extends HTMLAttributes<HTMLDivElement>, HasPlatform, HasInsets {\n  /**\n   * iOS only\n   */\n  header?: React.ReactNode;\n  /**\n   * iOS only\n   */\n  text?: React.ReactNode;\n  onClose(): void;\n}\n\nexport interface ActionSheetState {\n  closing: boolean;\n}\n\nexport type CloseCallback = () => void;\n\nexport type ClickHandler = (event: React.MouseEvent<HTMLDivElement>) => void;\n\nexport type ActionType = (event: React.MouseEvent) => void;\n\nexport type ItemClickHandler = (action: ActionType, autoclose: boolean) => (event: React.MouseEvent) => void;\n\nexport type AnimationEndCallback = (e?: AnimationEvent) => void;\n\nexport type IsItemLast = (index: number) => boolean;\n\nclass ActionSheet extends Component<ActionSheetProps, ActionSheetState> {\n  constructor(props: ActionSheetProps) {\n    super(props);\n    this.elRef = React.createRef();\n  }\n\n  state: ActionSheetState = {\n    closing: false,\n  };\n\n  elRef: React.RefObject<HTMLDivElement>;\n\n  onClose: CloseCallback = () => {\n    this.setState({ closing: true });\n    this.waitTransitionFinish(this.props.onClose);\n  };\n\n  onItemClick: ItemClickHandler = (action: ActionType, autoclose: boolean) => (event: React.MouseEvent) => {\n    event.persist();\n\n    if (autoclose) {\n      this.setState({ closing: true });\n      this.waitTransitionFinish(() => {\n        autoclose && this.props.onClose();\n        action && action(event);\n      });\n    } else {\n      action && action(event);\n    }\n  };\n\n  stopPropagation: ClickHandler = (e: React.MouseEvent<HTMLDivElement>) => e.stopPropagation();\n\n  waitTransitionFinish(eventHandler: AnimationEndCallback) {\n    if (transitionEvents.supported) {\n      const eventName = transitionEvents.prefix ? transitionEvents.prefix + 'TransitionEnd' : 'transitionend';\n\n      this.elRef.current.removeEventListener(eventName, eventHandler);\n      this.elRef.current.addEventListener(eventName, eventHandler);\n    } else {\n      setTimeout(eventHandler, this.props.platform === ANDROID ? 200 : 300);\n    }\n  }\n\n  isItemLast: IsItemLast = (index: number) => {\n    const childrenArray = Children.toArray(this.props.children);\n    const lastElement = childrenArray[childrenArray.length - 1] as ReactElement;\n\n    if (index === childrenArray.length - 1) {\n      return true;\n    } else if (index === childrenArray.length - 2 && lastElement.props.mode === 'cancel') {\n      return true;\n    }\n\n    return false;\n  };\n\n  render() {\n    const { children, className, header, text, style, insets, platform, ...restProps } = this.props;\n\n    return (\n      <PopoutWrapper\n        closing={this.state.closing}\n        alignY=\"bottom\"\n        className={className}\n        style={style}\n        onClick={this.onClose}\n      >\n        <div\n          {...restProps}\n          ref={this.elRef}\n          onClick={this.stopPropagation}\n          className={classNames(getClassName('ActionSheet', platform), {\n            'ActionSheet--closing': this.state.closing,\n          })}\n        >\n          {platform === IOS &&\n          <header className=\"ActionSheet__header\">\n            {header && <div className=\"ActionSheet__title\">{header}</div>}\n            {text && <div className=\"ActionSheet__text\">{text}</div>}\n          </header>\n          }\n          {Children.toArray(children).map((child: React.ReactElement, index: number, arr: []) =>\n            child && React.cloneElement(child, {\n              onClick: this.onItemClick(child.props.onClick, child.props.autoclose),\n              style: index === arr.length - 1 && isNumeric(insets.bottom) ? { marginBottom: insets.bottom } : null,\n              isLast: this.isItemLast(index),\n            }),\n          )}\n        </div>\n      </PopoutWrapper>\n    );\n  }\n}\n\nexport default withPlatform(withInsets(ActionSheet));\n"]},"metadata":{},"sourceType":"module"}