{"version":3,"sources":["../../../../src/components/Select/Select.tsx"],"names":["React","classNames","Icon24Dropdown","FormField","Select","props","e","setTitle","isControlledOutside","setState","value","currentTarget","onChange","selectedOption","selectEl","options","selectedIndex","title","text","notSelected","hasOwnProperty","element","getRef","current","state","defaultValue","prevProps","children","style","align","status","placeholder","className","getRootRef","top","bottom","disabled","restProps","Component"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, ChangeEventHandler, SelectHTMLAttributes } from 'react';\nimport classNames from '../../lib/classNames';\nimport Icon24Dropdown from '@vkontakte/icons/dist/24/dropdown';\nimport FormField from '../FormField/FormField';\nimport { HasAlign, HasFormLabels, HasFormStatus, HasRef, HasRootRef, OldRef } from '../../types';\n\nexport interface SelectProps extends\n  SelectHTMLAttributes<HTMLSelectElement>,\n  HasRef<HTMLSelectElement>,\n  HasRootRef<HTMLLabelElement>,\n  HasFormStatus,\n  HasFormLabels,\n  HasAlign {\n  defaultValue?: string;\n  placeholder?: string;\n}\n\nexport interface SelectState {\n  value?: string;\n  title?: string;\n  notSelected?: boolean;\n}\n\nexport default class Select extends React.Component<SelectProps, SelectState> {\n  constructor(props: SelectProps) {\n    super(props);\n    const state: SelectState = {\n      title: '',\n      notSelected: false,\n    };\n    if (typeof props.value !== 'undefined') {\n      this.isControlledOutside = true;\n    } else {\n      state.value = props.defaultValue || '';\n    }\n    this.state = state;\n  }\n\n  isControlledOutside?: boolean;\n  selectEl?: HTMLSelectElement;\n\n  onChange: ChangeEventHandler = (e: ChangeEvent<HTMLSelectElement>) => {\n    this.setTitle();\n    if (!this.isControlledOutside) {\n      this.setState({ value: e.currentTarget.value });\n    }\n    if (this.props.onChange) {\n      this.props.onChange(e);\n    }\n  };\n\n  setTitle: VoidFunction = () => {\n    const selectedOption = this.selectEl.options[this.selectEl.selectedIndex];\n    selectedOption && this.setState({\n      title: selectedOption.text,\n      notSelected: selectedOption.value === '' && this.props.hasOwnProperty('placeholder'),\n    });\n  };\n\n  componentDidUpdate(prevProps: SelectProps) {\n    if (prevProps.value !== this.props.value || prevProps.children !== this.props.children) {\n      this.setTitle();\n    }\n  }\n\n  componentDidMount() {\n    this.setTitle();\n  }\n\n  get value() {\n    return this.isControlledOutside ? this.props.value : this.state.value;\n  }\n\n  getRef: OldRef<HTMLSelectElement> = (element: HTMLSelectElement) => {\n    this.selectEl = element;\n\n    const getRef = this.props.getRef;\n    if (getRef) {\n      if (typeof getRef === 'function') {\n        getRef(element);\n      } else {\n        getRef.current = element;\n      }\n    }\n  };\n\n  render() {\n    const { style, value, defaultValue, onChange, align, status, placeholder, children, className,\n      getRef, getRootRef, top, bottom, disabled, ...restProps } = this.props;\n\n    return (\n      <FormField\n        Component=\"label\"\n        className={classNames('Select', {\n          ['Select--not-selected']: this.state.notSelected,\n          [`Select--align-${align}`]: !!align,\n          'Select--disabled': disabled,\n        }, className)}\n        style={style}\n        getRootRef={getRootRef}\n        status={status}\n      >\n        <select\n          {...restProps}\n          disabled={disabled}\n          className=\"Select__el\"\n          onChange={this.onChange}\n          value={this.value}\n          ref={this.getRef}\n        >\n          {placeholder && <option value=\"\">{placeholder}</option>}\n          {children}\n        </select>\n        <div className=\"Select__container\">\n          <div className=\"Select__title\">{this.state.title}</div>\n          <Icon24Dropdown />\n        </div>\n      </FormField>\n    );\n  }\n}\n"],"file":"Select.js"}