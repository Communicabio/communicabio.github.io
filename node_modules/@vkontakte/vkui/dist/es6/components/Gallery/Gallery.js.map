{"version":3,"sources":["../../../../src/components/Gallery/Gallery.tsx"],"names":["React","Component","getClassName","Touch","classNames","withPlatform","canUseDOM","Gallery","props","e","setState","animation","startT","isDraggable","originalEvent","preventDefault","isSlideX","onDragStart","state","deltaX","shiftX","dragging","targetIndex","isSlide","getTarget","current","onDragEnd","go","onEnd","initializeSlides","layerWidth","slides","containerWidth","container","offsetWidth","calculateIndent","min","calcMin","max","calcMax","window","requestAnimationFrame","duration","timeout","setTimeout","length","clearTimeout","id","slide","slidesStore","viewport","slideIndex","initialSlideIndex","onChange","logControlledError","createRef","console","error","callback","Children","map","children","_item","i","elem","coordX","offsetLeft","width","reduce","val","viewportWidth","align","isCenterWithCustomWidth","targetSlide","validateIndent","indent","Number","value","expectDeltaX","Date","now","getTime","shift","direction","item","index","previousValue","Math","abs","currentValue","addEventListener","onResize","prevProps","prevState","isChildrenDirty","removeEventListener","slideWidth","bullets","className","platform","restProps","calculateDragIndent","layerStyle","WebkitTransform","transform","WebkitTransition","transition","onStart","onMoveX","getViewportRef","getSlideRef"],"mappings":"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","sourcesContent":["import React, { Component, HTMLAttributes, ReactElement } from 'react';\nimport getClassName from '../../helpers/getClassName';\nimport Touch, { TouchEventHandler, TouchEvent } from '../Touch/Touch';\nimport classNames from '../../lib/classNames';\nimport withPlatform from '../../hoc/withPlatform';\nimport { HasAlign, HasPlatform, OldRef } from '../../types';\nimport { canUseDOM } from '../../lib/dom';\n\nexport interface GalleryProps extends\n  Omit<HTMLAttributes<HTMLDivElement>, 'onChange' | 'onDragStart' | 'onDragEnd'>,\n  HasPlatform,\n  HasAlign {\n  slideWidth?: string | number;\n  timeout?: number;\n  initialSlideIndex?: number;\n  slideIndex?: number;\n  onDragStart?: TouchEventHandler;\n  onDragEnd?: TouchEventHandler;\n  onChange?(current: GalleryState['current']): void;\n  onEnd?({ targetIndex }: { targetIndex: GalleryState['current'] }): void;\n  bullets?: 'dark' | 'light' | false;\n}\n\nexport interface GalleryState {\n  containerWidth: number;\n  layerWidth?: number;\n  min?: number;\n  max?: number;\n  startT?: Date;\n  current: number;\n  deltaX: number;\n  shiftX: number;\n  slides: GallerySlidesState[];\n  animation: boolean;\n  duration: number;\n  dragging?: boolean;\n}\n\nexport interface GallerySlidesState {\n  coordX: number;\n  width: number;\n}\n\ntype SetTimeout = (duration: number) => void;\n\ntype GetSlideRef = (index: number) => OldRef<HTMLElement>;\n\nclass Gallery extends Component<GalleryProps, GalleryState> {\n  constructor(props: GalleryProps) {\n    super(props);\n\n    const current = typeof props.slideIndex === 'number' ? props.slideIndex : props.initialSlideIndex;\n\n    if (!this.props.onChange && typeof this.props.slideIndex === 'number') {\n      this.logControlledError();\n    }\n\n    this.state = {\n      containerWidth: 0,\n      current,\n      deltaX: 0,\n      shiftX: 0,\n      slides: [],\n      animation: false,\n      duration: 0.24,\n    };\n\n    this.container = React.createRef();\n\n    this.slidesStore = {};\n  }\n\n  container: React.RefObject<HTMLDivElement>;\n  slidesStore: {\n    [index: string]: HTMLElement;\n  };\n  viewport: HTMLElement;\n  timeout: number;\n  isChildrenDirty: boolean;\n\n  static defaultProps: GalleryProps = {\n    slideWidth: '100%',\n    children: '',\n    timeout: 0,\n    initialSlideIndex: 0,\n    align: 'left',\n    bullets: false,\n  };\n\n  logControlledError() {\n    console.error('Failed prop type: You provided a `slideIndex` prop to `Gallery` without an `onChange` handler.');\n  }\n\n  get isCenterWithCustomWidth() {\n    return this.props.slideWidth === 'custom' && this.props.align === 'center';\n  }\n\n  initializeSlides(callback?: VoidFunction) {\n    const slides: GallerySlidesState[] = React.Children.map(\n      this.props.children,\n      (_item: ReactElement, i: number): GallerySlidesState => {\n        const elem = this.slidesStore[`slide-${i}`];\n        return {\n          coordX: elem.offsetLeft,\n          width: elem.offsetWidth,\n        };\n      });\n\n    const containerWidth = this.container.current.offsetWidth;\n    const layerWidth = slides.reduce((val: number, slide: GallerySlidesState) => slide.width + val, 0);\n\n    const min = this.calcMin({ containerWidth, layerWidth, slides });\n    const max = this.calcMax({ slides });\n\n    this.setState({ min, max, layerWidth, containerWidth, slides }, callback);\n  }\n\n  calcMin({ containerWidth, layerWidth, slides }: Pick<GalleryState, 'containerWidth' | 'layerWidth' | 'slides'>) {\n    const viewportWidth = this.viewport.offsetWidth;\n    switch (this.props.align) {\n      case 'left':\n        return containerWidth - layerWidth;\n      case 'right':\n        return viewportWidth - layerWidth;\n      case 'center':\n        if (this.isCenterWithCustomWidth && slides.length) {\n          const { coordX, width } = slides[slides.length - 1];\n          return viewportWidth / 2 - coordX - width / 2;\n        } else {\n          return viewportWidth - (containerWidth - viewportWidth) / 2 - layerWidth;\n        }\n    }\n  }\n\n  calcMax({ slides }: Pick<GalleryState, 'slides'>) {\n    const viewportWidth = this.viewport.offsetWidth;\n    if (this.isCenterWithCustomWidth && slides.length) {\n      const { width, coordX } = slides[0];\n      return viewportWidth / 2 - coordX - width / 2;\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи\n   */\n  calculateIndent(targetIndex: number) {\n    const { slides } = this.state;\n\n    if (!this.isDraggable) {\n      return 0;\n    }\n\n    const targetSlide = slides.length ? slides[targetIndex] : null;\n\n    if (targetSlide) {\n      const { coordX, width } = targetSlide;\n\n      if (this.isCenterWithCustomWidth) {\n        const viewportWidth = this.viewport.offsetWidth;\n        return viewportWidth / 2 - coordX - width / 2;\n      }\n\n      return this.validateIndent(-1 * coordX);\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи во время драга\n   */\n  calculateDragIndent() {\n    const { shiftX, deltaX, min, max } = this.state;\n    const indent = shiftX + deltaX;\n\n    if (indent > max) {\n      return max + Number((indent - max) / 3);\n    } else if (indent < min) {\n      return min + Number((indent - min) / 3);\n    }\n\n    return indent;\n  }\n\n  validateIndent(value: number) {\n    const { min, max } = this.state;\n\n    if (value < min) {\n      return min;\n    } else if (value > max) {\n      return max;\n    }\n\n    return value;\n  }\n\n  get isDraggable() {\n    return this.state.layerWidth > this.state.containerWidth;\n  }\n\n  /*\n   * Получает индекс слайда, к которому будет осуществлен переход\n   */\n  getTarget() {\n    const { slides, current, deltaX, shiftX, startT, max } = this.state;\n    const expectDeltaX = deltaX / (Date.now() - startT.getTime()) * 240 * 0.6;\n    const shift = shiftX + deltaX + expectDeltaX - max;\n    const direction = deltaX < 0 ? 1 : -1;\n\n    // Находим ближайшую границу слайда к текущему отступу\n    let targetIndex = slides.reduce((val: number, item: GallerySlidesState, index: number) => {\n      const previousValue = Math.abs(slides[val].coordX + shift);\n      const currentValue = Math.abs(item.coordX + shift);\n\n      return previousValue < currentValue ? val : index;\n    }, current);\n\n    if (targetIndex === current) {\n      let targetSlide = current + direction;\n\n      if (targetSlide >= 0 && targetSlide < slides.length) {\n        if (Math.abs(deltaX) > slides[targetSlide].width * 0.05) {\n          targetIndex = targetSlide;\n        }\n      }\n    }\n\n    return targetIndex;\n  }\n\n  go(targetIndex: number) {\n    if (typeof this.props.slideIndex === 'number' && !this.props.onChange) {\n      this.logControlledError();\n      this.setState({\n        animation: true,\n        deltaX: 0,\n        shiftX: this.calculateIndent(this.state.current),\n      });\n    } else {\n      this.setState({\n        animation: true,\n        deltaX: 0,\n        shiftX: this.calculateIndent(targetIndex),\n        current: targetIndex,\n      });\n\n      if (this.timeout) {\n        this.clearTimeout();\n        this.setTimeout(this.props.timeout);\n      }\n    }\n  };\n\n  onStart: TouchEventHandler = (e: TouchEvent) => {\n    this.setState({\n      animation: false,\n      startT: e.startT,\n    });\n  };\n\n  onMoveX: TouchEventHandler = (e: TouchEvent) => {\n    if (this.isDraggable) {\n      e.originalEvent.preventDefault();\n\n      if (e.isSlideX) {\n        this.props.onDragStart && this.props.onDragStart(e);\n\n        if (this.state.deltaX !== e.shiftX || this.state.dragging !== e.isSlideX) {\n          this.setState({\n            deltaX: e.shiftX,\n            dragging: e.isSlideX,\n          });\n        }\n      }\n    }\n  };\n\n  onEnd: TouchEventHandler = (e: TouchEvent) => {\n    const targetIndex = e.isSlide ? this.getTarget() : this.state.current;\n    this.props.onDragEnd && this.props.onDragEnd(e);\n    this.go(targetIndex);\n\n    if (this.props.onEnd) {\n      this.props.onEnd({ targetIndex });\n    }\n  };\n\n  onResize: VoidFunction = () => {\n    this.initializeSlides();\n\n    const { layerWidth, slides } = this.state;\n    const containerWidth = this.container.current.offsetWidth;\n\n    this.setState({\n      shiftX: this.calculateIndent(this.state.current),\n      containerWidth,\n      min: this.calcMin({ layerWidth, containerWidth, slides }),\n      max: this.calcMax({ slides }),\n      animation: false,\n    }, () => {\n      window.requestAnimationFrame(() => this.setState({ animation: true }));\n    });\n  };\n\n  setTimeout: SetTimeout = (duration: number) => {\n    if (canUseDOM) {\n      this.timeout = window.setTimeout(() => {\n        const { slides, current } = this.state;\n        const targetIndex = current < slides.length - 1 ? current + 1 : 0;\n\n        this.go(targetIndex);\n      }, duration);\n    }\n  };\n\n  clearTimeout: VoidFunction = () => {\n    clearTimeout(this.timeout);\n  };\n\n  getSlideRef: GetSlideRef = (id: number) => (slide: HTMLElement) => {\n    this.slidesStore[`slide-${id}`] = slide;\n  };\n\n  getViewportRef: OldRef<HTMLElement> = (viewport: HTMLElement) => {\n    this.viewport = viewport;\n  };\n\n  componentDidMount() {\n    this.initializeSlides(() => {\n      this.setState({\n        shiftX: this.calculateIndent(this.state.current),\n      });\n    });\n\n    window.addEventListener('resize', this.onResize);\n\n    if (this.props.timeout) {\n      this.setTimeout(this.props.timeout);\n    }\n  }\n\n  componentDidUpdate(prevProps: GalleryProps, prevState: GalleryState) {\n    if (this.props.children !== prevProps.children) {\n      this.isChildrenDirty = true;\n    }\n\n    if (this.isChildrenDirty) {\n      this.isChildrenDirty = false;\n      this.initializeSlides();\n    }\n    if (prevState.current !== this.state.current && this.props.onChange) {\n      this.props.onChange(this.state.current);\n    }\n\n    if (this.props.timeout && !prevProps.timeout) {\n      this.setTimeout(this.props.timeout);\n    }\n\n    if (!this.props.timeout && prevProps.timeout) {\n      this.clearTimeout();\n    }\n\n    if (this.props.slideIndex !== prevProps.slideIndex && typeof this.props.slideIndex === 'number') {\n      this.go(this.props.slideIndex);\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onResize);\n    this.clearTimeout();\n  }\n\n  render() {\n    const { animation, duration, current, dragging } = this.state;\n    const {\n      children,\n      slideWidth,\n      timeout,\n      initialSlideIndex,\n      slideIndex,\n      onDragStart,\n      onDragEnd,\n      onChange,\n      onEnd,\n      align,\n      bullets,\n      className,\n      platform,\n      ...restProps\n    } = this.props;\n\n    const indent = dragging ? this.calculateDragIndent() : this.calculateIndent(current);\n\n    const layerStyle = {\n      WebkitTransform: `translateX(${indent}px)`,\n      transform: `translateX(${indent}px)`,\n      WebkitTransition: animation ? `-webkit-transform ${duration}s cubic-bezier(.1, 0, .25, 1)` : 'none',\n      transition: animation ? `transform ${duration}s cubic-bezier(.1, 0, .25, 1)` : 'none',\n    };\n\n    return (\n      <div className={classNames(getClassName('Gallery', platform), className, `Gallery--${align}`, {\n        'Gallery--dragging': dragging,\n        'Gallery--custom-width': slideWidth === 'custom',\n      })} {...restProps} ref={this.container}>\n        <Touch\n          className=\"Gallery__viewport\"\n          onStartX={this.onStart}\n          onMoveX={this.onMoveX}\n          onEnd={this.onEnd}\n          style={{ width: slideWidth === 'custom' ? '100%' : slideWidth }}\n          getRootRef={this.getViewportRef}\n        >\n          <div className=\"Gallery__layer\" style={layerStyle}>\n            {React.Children.map(children, (item: ReactElement, i: number) =>\n              <div className=\"Gallery__slide\" key={`slide-${i}`} ref={this.getSlideRef(i)}>{item}</div>,\n            )}\n          </div>\n        </Touch>\n\n        {bullets &&\n        <div className={classNames('Gallery__bullets', `Gallery__bullets--${bullets}`)}>\n          {React.Children.map(children, (_item: ReactElement, index: number) =>\n            <div\n              className={classNames('Gallery__bullet', { 'Gallery__bullet--active': index === current })}\n              key={index}\n            />,\n          )}\n        </div>\n        }\n      </div>\n    );\n  }\n}\n\nexport default withPlatform(Gallery);\n"],"file":"Gallery.js"}