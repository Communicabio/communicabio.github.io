{"version":3,"sources":["../../../src/components/Gallery/Gallery.tsx"],"names":["Gallery","props","e","setState","animation","startT","isDraggable","originalEvent","preventDefault","isSlideX","onDragStart","state","deltaX","shiftX","dragging","targetIndex","isSlide","getTarget","current","onDragEnd","go","onEnd","initializeSlides","layerWidth","slides","containerWidth","container","offsetWidth","calculateIndent","min","calcMin","max","calcMax","window","requestAnimationFrame","duration","canUseDOM","timeout","setTimeout","length","clearTimeout","id","slide","slidesStore","viewport","slideIndex","initialSlideIndex","onChange","logControlledError","React","createRef","console","error","callback","Children","map","children","_item","i","elem","coordX","offsetLeft","width","reduce","val","viewportWidth","align","isCenterWithCustomWidth","targetSlide","validateIndent","indent","Number","value","expectDeltaX","Date","now","getTime","shift","direction","item","index","previousValue","Math","abs","currentValue","addEventListener","onResize","prevProps","prevState","isChildrenDirty","removeEventListener","slideWidth","bullets","className","platform","restProps","calculateDragIndent","layerStyle","WebkitTransform","transform","WebkitTransition","transition","onStart","onMoveX","getViewportRef","getSlideRef","Component"],"mappings":"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","sourcesContent":["import React, { Component, HTMLAttributes, ReactElement } from 'react';\nimport getClassName from '../../helpers/getClassName';\nimport Touch, { TouchEventHandler, TouchEvent } from '../Touch/Touch';\nimport classNames from '../../lib/classNames';\nimport withPlatform from '../../hoc/withPlatform';\nimport { HasAlign, HasPlatform, OldRef } from '../../types';\nimport { canUseDOM } from '../../lib/dom';\n\nexport interface GalleryProps extends\n  Omit<HTMLAttributes<HTMLDivElement>, 'onChange' | 'onDragStart' | 'onDragEnd'>,\n  HasPlatform,\n  HasAlign {\n  slideWidth?: string | number;\n  timeout?: number;\n  initialSlideIndex?: number;\n  slideIndex?: number;\n  onDragStart?: TouchEventHandler;\n  onDragEnd?: TouchEventHandler;\n  onChange?(current: GalleryState['current']): void;\n  onEnd?({ targetIndex }: { targetIndex: GalleryState['current'] }): void;\n  bullets?: 'dark' | 'light' | false;\n}\n\nexport interface GalleryState {\n  containerWidth: number;\n  layerWidth?: number;\n  min?: number;\n  max?: number;\n  startT?: Date;\n  current: number;\n  deltaX: number;\n  shiftX: number;\n  slides: GallerySlidesState[];\n  animation: boolean;\n  duration: number;\n  dragging?: boolean;\n}\n\nexport interface GallerySlidesState {\n  coordX: number;\n  width: number;\n}\n\ntype SetTimeout = (duration: number) => void;\n\ntype GetSlideRef = (index: number) => OldRef<HTMLElement>;\n\nclass Gallery extends Component<GalleryProps, GalleryState> {\n  constructor(props: GalleryProps) {\n    super(props);\n\n    const current = typeof props.slideIndex === 'number' ? props.slideIndex : props.initialSlideIndex;\n\n    if (!this.props.onChange && typeof this.props.slideIndex === 'number') {\n      this.logControlledError();\n    }\n\n    this.state = {\n      containerWidth: 0,\n      current,\n      deltaX: 0,\n      shiftX: 0,\n      slides: [],\n      animation: false,\n      duration: 0.24,\n    };\n\n    this.container = React.createRef();\n\n    this.slidesStore = {};\n  }\n\n  container: React.RefObject<HTMLDivElement>;\n  slidesStore: {\n    [index: string]: HTMLElement;\n  };\n  viewport: HTMLElement;\n  timeout: number;\n  isChildrenDirty: boolean;\n\n  static defaultProps: GalleryProps = {\n    slideWidth: '100%',\n    children: '',\n    timeout: 0,\n    initialSlideIndex: 0,\n    align: 'left',\n    bullets: false,\n  };\n\n  logControlledError() {\n    console.error('Failed prop type: You provided a `slideIndex` prop to `Gallery` without an `onChange` handler.');\n  }\n\n  get isCenterWithCustomWidth() {\n    return this.props.slideWidth === 'custom' && this.props.align === 'center';\n  }\n\n  initializeSlides(callback?: VoidFunction) {\n    const slides: GallerySlidesState[] = React.Children.map(\n      this.props.children,\n      (_item: ReactElement, i: number): GallerySlidesState => {\n        const elem = this.slidesStore[`slide-${i}`];\n        return {\n          coordX: elem.offsetLeft,\n          width: elem.offsetWidth,\n        };\n      });\n\n    const containerWidth = this.container.current.offsetWidth;\n    const layerWidth = slides.reduce((val: number, slide: GallerySlidesState) => slide.width + val, 0);\n\n    const min = this.calcMin({ containerWidth, layerWidth, slides });\n    const max = this.calcMax({ slides });\n\n    this.setState({ min, max, layerWidth, containerWidth, slides }, callback);\n  }\n\n  calcMin({ containerWidth, layerWidth, slides }: Pick<GalleryState, 'containerWidth' | 'layerWidth' | 'slides'>) {\n    const viewportWidth = this.viewport.offsetWidth;\n    switch (this.props.align) {\n      case 'left':\n        return containerWidth - layerWidth;\n      case 'right':\n        return viewportWidth - layerWidth;\n      case 'center':\n        if (this.isCenterWithCustomWidth && slides.length) {\n          const { coordX, width } = slides[slides.length - 1];\n          return viewportWidth / 2 - coordX - width / 2;\n        } else {\n          return viewportWidth - (containerWidth - viewportWidth) / 2 - layerWidth;\n        }\n    }\n  }\n\n  calcMax({ slides }: Pick<GalleryState, 'slides'>) {\n    const viewportWidth = this.viewport.offsetWidth;\n    if (this.isCenterWithCustomWidth && slides.length) {\n      const { width, coordX } = slides[0];\n      return viewportWidth / 2 - coordX - width / 2;\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи\n   */\n  calculateIndent(targetIndex: number) {\n    const { slides } = this.state;\n\n    if (!this.isDraggable) {\n      return 0;\n    }\n\n    const targetSlide = slides.length ? slides[targetIndex] : null;\n\n    if (targetSlide) {\n      const { coordX, width } = targetSlide;\n\n      if (this.isCenterWithCustomWidth) {\n        const viewportWidth = this.viewport.offsetWidth;\n        return viewportWidth / 2 - coordX - width / 2;\n      }\n\n      return this.validateIndent(-1 * coordX);\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи во время драга\n   */\n  calculateDragIndent() {\n    const { shiftX, deltaX, min, max } = this.state;\n    const indent = shiftX + deltaX;\n\n    if (indent > max) {\n      return max + Number((indent - max) / 3);\n    } else if (indent < min) {\n      return min + Number((indent - min) / 3);\n    }\n\n    return indent;\n  }\n\n  validateIndent(value: number) {\n    const { min, max } = this.state;\n\n    if (value < min) {\n      return min;\n    } else if (value > max) {\n      return max;\n    }\n\n    return value;\n  }\n\n  get isDraggable() {\n    return this.state.layerWidth > this.state.containerWidth;\n  }\n\n  /*\n   * Получает индекс слайда, к которому будет осуществлен переход\n   */\n  getTarget() {\n    const { slides, current, deltaX, shiftX, startT, max } = this.state;\n    const expectDeltaX = deltaX / (Date.now() - startT.getTime()) * 240 * 0.6;\n    const shift = shiftX + deltaX + expectDeltaX - max;\n    const direction = deltaX < 0 ? 1 : -1;\n\n    // Находим ближайшую границу слайда к текущему отступу\n    let targetIndex = slides.reduce((val: number, item: GallerySlidesState, index: number) => {\n      const previousValue = Math.abs(slides[val].coordX + shift);\n      const currentValue = Math.abs(item.coordX + shift);\n\n      return previousValue < currentValue ? val : index;\n    }, current);\n\n    if (targetIndex === current) {\n      let targetSlide = current + direction;\n\n      if (targetSlide >= 0 && targetSlide < slides.length) {\n        if (Math.abs(deltaX) > slides[targetSlide].width * 0.05) {\n          targetIndex = targetSlide;\n        }\n      }\n    }\n\n    return targetIndex;\n  }\n\n  go(targetIndex: number) {\n    if (typeof this.props.slideIndex === 'number' && !this.props.onChange) {\n      this.logControlledError();\n      this.setState({\n        animation: true,\n        deltaX: 0,\n        shiftX: this.calculateIndent(this.state.current),\n      });\n    } else {\n      this.setState({\n        animation: true,\n        deltaX: 0,\n        shiftX: this.calculateIndent(targetIndex),\n        current: targetIndex,\n      });\n\n      if (this.timeout) {\n        this.clearTimeout();\n        this.setTimeout(this.props.timeout);\n      }\n    }\n  };\n\n  onStart: TouchEventHandler = (e: TouchEvent) => {\n    this.setState({\n      animation: false,\n      startT: e.startT,\n    });\n  };\n\n  onMoveX: TouchEventHandler = (e: TouchEvent) => {\n    if (this.isDraggable) {\n      e.originalEvent.preventDefault();\n\n      if (e.isSlideX) {\n        this.props.onDragStart && this.props.onDragStart(e);\n\n        if (this.state.deltaX !== e.shiftX || this.state.dragging !== e.isSlideX) {\n          this.setState({\n            deltaX: e.shiftX,\n            dragging: e.isSlideX,\n          });\n        }\n      }\n    }\n  };\n\n  onEnd: TouchEventHandler = (e: TouchEvent) => {\n    const targetIndex = e.isSlide ? this.getTarget() : this.state.current;\n    this.props.onDragEnd && this.props.onDragEnd(e);\n    this.go(targetIndex);\n\n    if (this.props.onEnd) {\n      this.props.onEnd({ targetIndex });\n    }\n  };\n\n  onResize: VoidFunction = () => {\n    this.initializeSlides();\n\n    const { layerWidth, slides } = this.state;\n    const containerWidth = this.container.current.offsetWidth;\n\n    this.setState({\n      shiftX: this.calculateIndent(this.state.current),\n      containerWidth,\n      min: this.calcMin({ layerWidth, containerWidth, slides }),\n      max: this.calcMax({ slides }),\n      animation: false,\n    }, () => {\n      window.requestAnimationFrame(() => this.setState({ animation: true }));\n    });\n  };\n\n  setTimeout: SetTimeout = (duration: number) => {\n    if (canUseDOM) {\n      this.timeout = window.setTimeout(() => {\n        const { slides, current } = this.state;\n        const targetIndex = current < slides.length - 1 ? current + 1 : 0;\n\n        this.go(targetIndex);\n      }, duration);\n    }\n  };\n\n  clearTimeout: VoidFunction = () => {\n    clearTimeout(this.timeout);\n  };\n\n  getSlideRef: GetSlideRef = (id: number) => (slide: HTMLElement) => {\n    this.slidesStore[`slide-${id}`] = slide;\n  };\n\n  getViewportRef: OldRef<HTMLElement> = (viewport: HTMLElement) => {\n    this.viewport = viewport;\n  };\n\n  componentDidMount() {\n    this.initializeSlides(() => {\n      this.setState({\n        shiftX: this.calculateIndent(this.state.current),\n      });\n    });\n\n    window.addEventListener('resize', this.onResize);\n\n    if (this.props.timeout) {\n      this.setTimeout(this.props.timeout);\n    }\n  }\n\n  componentDidUpdate(prevProps: GalleryProps, prevState: GalleryState) {\n    if (this.props.children !== prevProps.children) {\n      this.isChildrenDirty = true;\n    }\n\n    if (this.isChildrenDirty) {\n      this.isChildrenDirty = false;\n      this.initializeSlides();\n    }\n    if (prevState.current !== this.state.current && this.props.onChange) {\n      this.props.onChange(this.state.current);\n    }\n\n    if (this.props.timeout && !prevProps.timeout) {\n      this.setTimeout(this.props.timeout);\n    }\n\n    if (!this.props.timeout && prevProps.timeout) {\n      this.clearTimeout();\n    }\n\n    if (this.props.slideIndex !== prevProps.slideIndex && typeof this.props.slideIndex === 'number') {\n      this.go(this.props.slideIndex);\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onResize);\n    this.clearTimeout();\n  }\n\n  render() {\n    const { animation, duration, current, dragging } = this.state;\n    const {\n      children,\n      slideWidth,\n      timeout,\n      initialSlideIndex,\n      slideIndex,\n      onDragStart,\n      onDragEnd,\n      onChange,\n      onEnd,\n      align,\n      bullets,\n      className,\n      platform,\n      ...restProps\n    } = this.props;\n\n    const indent = dragging ? this.calculateDragIndent() : this.calculateIndent(current);\n\n    const layerStyle = {\n      WebkitTransform: `translateX(${indent}px)`,\n      transform: `translateX(${indent}px)`,\n      WebkitTransition: animation ? `-webkit-transform ${duration}s cubic-bezier(.1, 0, .25, 1)` : 'none',\n      transition: animation ? `transform ${duration}s cubic-bezier(.1, 0, .25, 1)` : 'none',\n    };\n\n    return (\n      <div className={classNames(getClassName('Gallery', platform), className, `Gallery--${align}`, {\n        'Gallery--dragging': dragging,\n        'Gallery--custom-width': slideWidth === 'custom',\n      })} {...restProps} ref={this.container}>\n        <Touch\n          className=\"Gallery__viewport\"\n          onStartX={this.onStart}\n          onMoveX={this.onMoveX}\n          onEnd={this.onEnd}\n          style={{ width: slideWidth === 'custom' ? '100%' : slideWidth }}\n          getRootRef={this.getViewportRef}\n        >\n          <div className=\"Gallery__layer\" style={layerStyle}>\n            {React.Children.map(children, (item: ReactElement, i: number) =>\n              <div className=\"Gallery__slide\" key={`slide-${i}`} ref={this.getSlideRef(i)}>{item}</div>,\n            )}\n          </div>\n        </Touch>\n\n        {bullets &&\n        <div className={classNames('Gallery__bullets', `Gallery__bullets--${bullets}`)}>\n          {React.Children.map(children, (_item: ReactElement, index: number) =>\n            <div\n              className={classNames('Gallery__bullet', { 'Gallery__bullet--active': index === current })}\n              key={index}\n            />,\n          )}\n        </div>\n        }\n      </div>\n    );\n  }\n}\n\nexport default withPlatform(Gallery);\n"],"file":"Gallery.js"}