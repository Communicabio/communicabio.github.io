{"version":3,"sources":["img/communicabio.svg","panels/Params.js","panels/Home.js","panels/Rating.js","panels/Settings.js","App.js","index.js"],"names":["module","exports","__webpack_require__","p","SERVER_URL","EndOfDialog","React","Component","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","instance","createRef","script","document","createElement","run","dialog_id","text","async","console","log","current","appendChild","_this2","scores","react_default","a","map","element","Alert_default","id","actionsLayout","actions","title","autoclose","mode","action","onClose","create_feedback_panel","ref","Home","_this3","state","popout","history","disabled","token","create_alert","bind","assertThisInitialized","prepare_alert","get_reply_to","handle_send_message","rollback_dialog","remove_alert","message2Cell","onHandleFormChange","onHandleFormSubmit","get_new_dialog","get_score","get_chat_history","isTooltipClosed","closeTooltip","renderFeedbackPanel","renderScorePanel","then","length","setState","fetch","URLSearchParams","json","formatted_list","last_dialog","user","i","push","actor","method","body","JSON","stringify","response","chat_history","localStorage","setItem","headers","Content-Type","ok","status","msg","message","result","_this4","flag","_this5","_this6","Card_default","size","forEach","item","es6","isShown","tooltip","offsetX","Cell_default","_this7","Panel_default","Div_default","renderMessage","style","height","vertical","Button_default","onClick","Home_EndOfDialog","ind","ind2","hint_count","mistakes","metric","mistake","word","_this8","dict","score","toFixed","multiline","before","Avatar_default","src","require","e","user_message","target","value","preventDefault","array","tooltips","j","repl","PanelHeader_default","marginTop","_this9","0","1","display","stretched","marginRight","arrow_uturn_left_outline_default","cancel_default","Separator_default","position","Textarea_default","float","marginBottom","onChange","defaultValue","send_default","chatRender","loadigRender","Rating","N","M","place","our_place","table","changePlace","getUserInfo","renderRating","getRatingTable","goHome","start","end","n","m","rating","CardGrid_default","entry","delta","info","Math","max","up_default","home_outline_default","down_default","Settings","lang","hints","updateLang","FormLayout_default","top","name","description","checked","bottom","updateHints","App","parseQueryString","string","slice","split","queryParam","kvp","key","reduce","query","go","activePanel","currentTarget","dataset","to","fetchedUser","activeStory","renderHome","renderSettings","onStoryChange","obtainToken","story","urlParams","window","location","search","req_params","data","src_panels_Home","panels_Rating","panels_Settings","tabbar","selected","data-story","chats_outline_default","list_outline_default","settings_default","connect","send","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.69120a5c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/communicabio.e8edc935.svg\";","var SERVER_URL = \"https://communicabio-server-b7e3qu3u4a-uc.a.run.app/\";\nexport default SERVER_URL;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport List from '@vkontakte/vkui/dist/components/List/List'\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout'\nimport Textarea from '@vkontakte/vkui/dist/components/Textarea/Textarea'\nimport Card from '@vkontakte/vkui/dist/components/Card/Card'\nimport CardGrid from '@vkontakte/vkui/dist/components/CardGrid/CardGrid'\nimport Input from '@vkontakte/vkui/dist/components/Input/Input'\nimport Separator from '@vkontakte/vkui/dist/components/Separator/Separator'\nimport Alert from '@vkontakte/vkui/dist/components/Alert/Alert'\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell'\nimport Icon24Send from '@vkontakte/icons/dist/24/send';\nimport Icon24ArrowUturnLeftOutline from '@vkontakte/icons/dist/24/arrow_uturn_left_outline';\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport './Home.css'\nimport SERVER_URL from './Params'\nimport ReactDOM from 'react-dom'\nimport {FixedLayout} from '@vkontakte/vkui'\nimport { Tooltip} from '@vkontakte/vkui';\nimport { PanelSpinner, ScreenSpinner, Spinner } from '@vkontakte/vkui';\nimport { useRef, useEffect} from \"react\"\n\nvar node_before_alert = null;\n\nclass Example extends React.Component {\n\tconstructor(props) {\n\t\tsuper();\n\t}\n\n\trender() {\n\t\treturn <p>some text</p>\n\t}\n}\n\nclass EndOfDialog extends React.Component {\n\tconstructor(props) {\n\t\tsuper();\n\t\tthis.props = props;\n\t\tthis.instance = React.createRef()\n\t}\n\n\tcomponentDidMount() {\n\t\tconst script = document.createElement(\"script\"); // document.getElementById(\"vk-share\").appendChild\n\t\tvar vk_table = 'VK.Share.button({url: \"https://communicabio.github.io/share?dialog=' + this.props.dialog_id + '\"},{type: \"round_nocount\", text: \"Поделиться диалогом\"});';\n\t\tvar run = \"var htmlobj = document.createElement('div'); htmlobj.innerHTML = \" + vk_table + \";console.log(htmlobj);document.getElementById('vk-share').appendChild(htmlobj);\"\n\t\tscript.text = run\n\t\tscript.async = true;\n\t\tconsole.log(this.instance);\n\t\tconsole.log(this.instance.current);\n\t\tthis.instance.current.appendChild(script);\n\t}\n\n\trender() {\n\t\t//const instance = useRef(null);\n\t\tvar scores = this.props.scores;\n\t\tconsole.log(\"dialog scores\");\n\t\tconsole.log(scores);\n\t\tif (scores[0]['score'] < 0) {\n\t\t\t\ttext = <p>К сожалению, у нас пока нет нормальных критериев оценки на английском. Через пару дней все изменится</p>\n\t\t} else {\n\t\t\tvar text = <p>\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tscores.map(element => <p>Ваши баллы за {element['metric']}: {element['score']}<br/></p>)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t </p>\n\t\t}\n\n\t\treturn (<Alert id=\"end-of-dialog-alert\" actionsLayout=\"vertical\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t actions={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t title: 'Продолжить',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t autoclose: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t mode: 'default',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t action: () => {},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClose={() => {console.log('create_feedback_panel33'); this.props.create_feedback_panel()}}>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h2>Завершение диалога</h2>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{text}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div ref={this.instance}></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div id=\"vk-share\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</Alert>);\n\t} //\n}\n\nclass Home extends React.Component {\n\tconstructor(props) {\n\t\t super();\n\t\t console.log('home-init');\n\t\t this.state = {popout: null, history: [], disabled: false, token: null};\n\t\t this.props = props\n\t\t console.log(this.props)\n\t\t this.create_alert = this.create_alert.bind(this);\n\t\t this.prepare_alert = this.prepare_alert.bind(this);\n\t\t //this.add_chat_message = this.add_chat_message.bind(this);\n\t\t this.get_reply_to = this.get_reply_to.bind(this);\n\t\t this.handle_send_message = this.handle_send_message.bind(this);\n\t \t this.rollback_dialog = this.rollback_dialog.bind(this);\n\t \t this.remove_alert = this.remove_alert.bind(this);\n\t\t this.message2Cell = this.message2Cell.bind(this);\n\t\t this.onHandleFormChange = this.onHandleFormChange.bind(this);\n\t\t this.onHandleFormSubmit = this.onHandleFormSubmit.bind(this);\n\t\t this.get_new_dialog = this.get_new_dialog.bind(this);\n\t\t this.get_score = this.get_score.bind(this);\n\t\t this.get_chat_history = this.get_chat_history.bind(this);\n\t\t this.isTooltipClosed = this.isTooltipClosed.bind(this);\n\t\t this.closeTooltip = this.closeTooltip.bind(this);\n\t\t this.create_feedback_panel = this.create_feedback_panel.bind(this);\n\t\t this.renderFeedbackPanel = this.renderFeedbackPanel.bind(this);\n\t\t this.renderScorePanel = this.renderScorePanel.bind(this);\n\n\t \t this.get_chat_history().then(history => {\n\t\t\t if (history.length == 0) {\n\t\t\t\t this.get_new_dialog().then(history => {this.setState({history: history})});\n\t\t \t } else {\n\t\t\t\t \tthis.setState({history: history});\n\t\t\t }\n\t\t});\n\t}\n\n\tasync get_chat_history() {\n\t\tif (this.props.token === \"not-obtained\") {\n\t\t\treturn []\n\t\t}\n\t\tconsole.log('get---user ' + this.props.token)\n\t\tvar json = await fetch(SERVER_URL + 'user?' + new URLSearchParams({token: this.props.token}));\n\t\tvar formatted_list = []\n\t\tjson = await json.json();\n\t\tconsole.log(json)\n\t\tvar last_dialog = json.user.last_dialog;\n\t\tconsole.log(last_dialog);\n\t\tif (last_dialog == null) {\n\t\t\treturn [];\n\t\t}\n\t\tfor (var i = 0; i < last_dialog.length; i += 1) {\n\t\t\tformatted_list.push({'text': last_dialog[i], 'actor': i % 2})\n\t\t}\n\t\tconsole.log('last_dialog ' + formatted_list);\n\t\treturn formatted_list\n\t}\n\n\tasync get_new_dialog() {\n\t\tconsole.log(\"get_new_dialog \");\n\t\tconst token = this.props.token;\n\t\tif (token == 'not-obtained') {\n\t\t\treturn []\n\t\t}\n\t\tvar response = await fetch(SERVER_URL + 'start_dialog', {method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\tbody: JSON.stringify({'token': token})});\n\t\tvar json = await response.json();\n\t\tvar text = json['first_message']\n\t\tvar chat_history = [{'actor': 0, 'text': text}];\n\t\tlocalStorage.setItem('chat_history', JSON.stringify(chat_history));\n\t\treturn chat_history;\n\t}\n\n\tasync get_score(history) {\n\t\tconst token = this.props.token;\n\t\tvar response = await fetch(SERVER_URL + 'finish_dialog', {method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': token\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}})\n\t\tconsole.log(\"response\")\n\t\tconsole.log(response.ok)\n\t\tconsole.log(response.status)\n\t\tif (!response.ok) {\n\t\t\t\tthis.remove_alert(1);\n\t\t\t\treturn null;\n\t\t}\n\t\tvar json = await response.json();\n\t\tconsole.log('get_score ' + json)\n\t\treturn json;\n\t}\n\n\tasync get_reply_to(msg) {\n\t\tvar history = this.state.history;\n\t\thistory.push({'text': msg, 'actor': 1});\n\t\tconsole.log(history);\n\t\tthis.setState({history: history, disabled: true});\n\n\t\tfetch(\n\t\t\tSERVER_URL + 'reply',\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: JSON.stringify(\n\t\t\t\t\t{\n\t\t\t\t\t\t'token': this.props.token,\n\t\t\t\t\t\t'message': msg\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t}\n\t\t\t}\n\t\t).then(result => {\n\t\t\tthis.get_chat_history().then(\n\t\t\t\thistory => this.setState({history: history, disabled: false})\n\t\t\t);\n\t\t});\n\t\tconsole.log(this.state);\n\t}\n\n\thandle_send_message() {\n\t\treturn;\n\t\tthis.add_chat_message(this.state.user_message, 1);\n\t\tthis.get_reply_to(\"\");\n\t}\n\n \tasync rollback_dialog() {\n\t\t// send request to server\n\t\tthis.setState({disabled: true})\n\t\tvar response = await fetch(SERVER_URL + 'rollback',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t body: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': this.props.token\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}});\n\t\tvar chat_history = await this.get_chat_history();\n\t\tthis.setState({history: chat_history, disabled: false});\n\t}\n\n\tremove_alert(flag) {\n\t\tconsole.log('remove alert');\n\t\tif (flag) {\n\t\t\tthis.get_new_dialog().then(history => {this.setState({popout: null, history: history})});\n\t\t} else {\n\t\t\tthis.setState({popout: null});\n\t\t}\n\t\t//get_new_dialog().then(history => {this.setState({history: history})});\n\t}\n\n\trenderMessage(message) {\n\t\tconsole.log(\"renderMessage \" + JSON.stringify(message));\n\t\tif (message['actor'] == 0) {\n\t\t\treturn <Card mode=\"shadow\" size='l'>{this.message2Cell(message)}</Card>\n\t\t}\n\t\tif (message['mistakes'].length == 0) {\n\t\t\treturn <Card mode=\"tint\" size='l'>{this.message2Cell(message)}</Card>\n\t\t}\n\t\tconsole.log(message['mistakes']);\n\t\tvar text = \"\";\n\t\tmessage['mistakes'].forEach((item, i) => {\n\t\t\t\ttext += '«' + item['word'] + '» портит показатель «' + item['metric'] + '»\\n';\n\t\t});\n\t\tconsole.log(text);\n\t\t// this.setState({ tooltip: this.state.tooltip + 1})\n\t\tvar element =  <Tooltip\n\t\t\t\t\t\t\t\t\t\t\ttext={text}\n\t\t\t\t\t\t\t\t\t\t\tisShown={this.state.tooltip == message['ind']}\n\t\t\t\t\t\t\t \t\t\t\tonClose={() => this.setState({tooltip: this.state.tooltip + 1})}\n\t\t\t\t\t\t\t\t\t\t\toffsetX={10}\n\t\t\t\t\t \t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Cell><Card mode=\"tint\" size='l'>{this.message2Cell(message)}</Card></Cell>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\tconsole.log(element);\n\n\t\treturn element;\n\n\t}\n\n\trenderFeedbackPanel() {\n\t\treturn <Panel id={this.props.id}>\n\t\t\t\t\t\t\t\t<Div id=\"chat-parent\">\n\t\t\t\t\t\t\t\t\t\t{this.history.map(message =>\n\t\t\t\t\t\t\t\t\t\t\tthis.renderMessage(message))}\n\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t\t<Div style={{height: \"50px\"}}></Div>\n\n\t\t\t\t\t\t\t\t<FixedLayout vertical=\"bottom\">\n\t\t\t\t\t\t\t\t\t <Button size=\"xl\" mode=\"secondary\" onClick={() => this.remove_alert(1)}>Все понятно</Button>\n\t\t\t\t\t\t\t\t</FixedLayout>\n\t\t\t\t\t</Panel>\n\t}\n\n\trenderScorePanel() {\n\t\treturn <EndOfDialog scores={this.state.scores} dialog_id={this.state.dialog_id} create_feedback_panel={this.create_feedback_panel}/>\n\t}\n\n\tcreate_feedback_panel() {\n\t\tvar scores = this.scores;\n\t\tvar history = this.state.history;\n\t\tconsole.log('create_feedback_panel');\n\t\tconsole.log(history);\n\t\tconsole.log(scores);\n\t\tthis.history = this.state.history;\n\t\tlet ind = 0;\n\t\tlet ind2 = 0;\n\t\tlet hint_count = 0;\n\t\tfor(var i = 0; i < this.history.length; i += 1) {\n\t\t\tconsole.log(i);\n\t\t\tif (this.history[i]['actor'] == 0) {this.history[i]['mistakes'] = []}\n\t\t\telse {\n\t\t\t\tvar mistakes = [];\n\t\t\t\tthis.history[i]['ind'] = ind2;\n\t\t\t\tscores.forEach(element => {\n\t\t\t\t\tvar metric = element['metric'];\n\t\t\t\t\telement['mistakes'].forEach(mistake => {\n\t\t\t\t\t\tif (mistake[0] === ind) {\n\t\t\t\t\t\t\tmistakes.push({'metric': metric, 'word': mistake[1]});\n\t\t\t\t\t\t\thint_count += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t\tthis.history[i]['mistakes'] = mistakes;\n\t\t\t\tind2 += mistakes.length >= 1;\n\t\t\t\tind += 1;\n\t\t\t}\n\t\t}\n\t\tconsole.log('hint_count ' + hint_count);\n\t\tif (hint_count == 0) {\n\t\t\tconsole.log('hint_count == 0')\n\t\t\tthis.remove_alert(1);\n\t\t\treturn;\n\t\t}\n\t\tthis.setState({popout: \"feedback\", tooltip: 0});\n\t}\n\n\tcreate_alert(scores, dialog_id) {\n\t\tconsole.log(\"dialog scores\");\n\t\tconsole.log(scores);\n\t\tthis.scores = scores;\n\t\tthis.setState({popout: \"scorepanel\", scores: scores, dialog_id: dialog_id});\n\t}\n\n \tasync prepare_alert() {\n\t\tthis.setState({disabled: true, popout: \"loading\"});\n\t\tvar chat_history = await this.get_chat_history();\n\t\tthis.setState({history: chat_history});\n\t\tthis.get_score(chat_history).then((response) => {\n\t\t\tthis.setState({disabled: false})\n\t\t\tif (response === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconsole.log(response);\n\t\t\tvar dialog_id = response['dialog']\n\t\t\tresponse = response['metrics']\n\t\t\tvar dict = [{'metric': 'вежливость', 'score': (2 + 3 * response['politeness']['score']).toFixed(2), 'mistakes': response['politeness']['mistakes']},\n\t\t\t\t\t\t\t\t\t{'metric': 'позитивность', 'score': (2  + 3 * response['positivity']['score']).toFixed(2), 'mistakes': response['positivity']['mistakes']}];\n\t\t\tthis.create_alert(dict, dialog_id);\n\t\t});\n\t}\n\n\tmessage2Cell(message) {\n\t\tif (message['actor'] == 0) {\n\t\t\treturn <Cell multiline before={<Avatar src={require(\"../img/communicabio.svg\")}/>}>\n\t\t\t\t\t\t\t\t{message['text']}\n\t\t\t\t\t\t\t</Cell>\n\t\t} else {\n\t\t\treturn <Cell multiline>{message['text']}</Cell>\n\t\t}\n\t}\n\n\tonHandleFormChange(e) {\n\t\tthis.setState({\n\t\t user_message: e.target.value\n\t });\n\t}\n\n\tonHandleFormSubmit(e) {\n\t\te.preventDefault();\n\t\tconst text = this.state.user_message;\n\t\tconsole.log(text);\n\t\tthis.get_reply_to(text);\n\t\t//this.setState({user_message: \"\"});\n\t\t//console.log('user-message: ' + this.state.user_message);\n\t}\n\n\tisTooltipClosed(i) {\n\t\tvar array = this.state.tooltips;\n\t\tfor (var j = 0; j < array.length; j += 1) {\n\t\t\tif (array[j] == i) return false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tcloseTooltip(i) {\n\t\tvar array = this.state.tooltips;\n\t\tvar repl = []\n\t\tfor (var j = 0; j < array.length; j += 1) {\n\t\t\tif (array[j] != i) repl.push(array[j]);\n\t\t}\n\t\tif (repl.length == 0) {\n\n\t\t}\n\t\tthis.setState({tooltips: repl});\n\t}\n\n\tloadigRender() {\n\t\treturn <Panel id={this.props.id}>\n \t\t\t\t\t\t<PanelHeader>Чат</PanelHeader>\n\t\t\t\t\t\t<Spinner size=\"large\" style={{ marginTop: 50 }} />\n\t\t \t\t\t\t</Panel>\n\t}\n\n\tchatRender() {\n\t\treturn <Panel id={this.props.id}>\n\t\t\t<PanelHeader>Чат</PanelHeader>\n\t\t\t<Div id=\"chat-parent\">\n\t\t\t\t\t{this.state['history'].map(message =>\n\t\t\t\t\t\t<Card mode={{0: \"shadow\", 1: \"tint\"}[message['actor']]} size='l'>\n\t\t\t\t\t\t\t{this.message2Cell(message)}\n\t\t\t\t\t\t </Card>\n\t\t\t\t\t)}\n\n\n\t\t\t</Div>\n\n\t\t\t<Div style={{height: \"130px\"}}></Div>\n\n\n\t\t\t<FixedLayout vertical=\"bottom\">\n\t\t\t\t<Div>\n\t\t\t\t\t<Div style={{display: 'flex'}}>\n\t\t       <Button size=\"l\" stretched style={{ marginRight: 8 }}\n\t\t\t\t\t \t\t\t\tbefore={<Icon24ArrowUturnLeftOutline/>} disabled={this.state.disabled} onClick={() => this.rollback_dialog(this)}>Отмена</Button>\n\t\t       <Button size=\"l\" stretched mode=\"secondary\" disabled={this.state.disabled} before={<Icon24Cancel/>} onClick={this.prepare_alert}>Закончить</Button>\n\t\t     \t</Div>\n\t\t\t\t\t<Separator/>\n\t\t\t\t\t<Div style={{'position': 'relative'}}>\n\t\t\t\t\t\t<Textarea style={{\"float\": \"left\", 'marginBottom': \"10px\", \"marginRight\": \"10px\"}} onChange={this.onHandleFormChange} defaultValue={this.state.user_message}></Textarea>\n\t\t\t\t\t\t<Button onClick={this.onHandleFormSubmit} disabled={this.state.disabled} before={<Icon24Send/>} style={{\"float\": \"left\"}}></Button>\n\t\t\t\t\t</Div>\n\t\t\t\t</Div>\n\t\t\t</FixedLayout>\n\t\t</Panel>\n\t}\n\n  render() {\n\t\tconsole.log('home-render')\n\t\tconsole.log(this.props);\n\t\t//console.log(this.state.popout == null)\n\t\t/*this.history = [{'text': \"dddgggg\", \"actor\": 1, \"mistakes\": [{\"metric\": \"m\", \"word\": \"w\"}]}];\n\t\treturn this.renderFeedbackPanel()*/\n\n\t\tif (this.state.popout == null) {\n\t\t\treturn this.chatRender();\n\t\t} else {\n\t\t\tif (this.state.popout === \"feedback\") {\n\t\t\t\treturn this.renderFeedbackPanel();\n\t\t\t}\n\t\t\tif (this.state.popout === \"loading\") {\n\t\t\t\treturn this.loadigRender();\n\t\t\t}\n\t\t\tif (this.state.popout === \"scorepanel\") {\n\t\t\t\treturn this.renderScorePanel();\n\t\t\t}\n\t\t\treturn this.state.popout;\n\t\t}\n\t}\n}\n\nexport default Home;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport List from '@vkontakte/vkui/dist/components/List/List'\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout'\nimport Textarea from '@vkontakte/vkui/dist/components/Textarea/Textarea'\nimport Card from '@vkontakte/vkui/dist/components/Card/Card'\nimport CardGrid from '@vkontakte/vkui/dist/components/CardGrid/CardGrid'\nimport Input from '@vkontakte/vkui/dist/components/Input/Input'\nimport Separator from '@vkontakte/vkui/dist/components/Separator/Separator'\nimport Alert from '@vkontakte/vkui/dist/components/Alert/Alert'\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell'\nimport Icon24Send from '@vkontakte/icons/dist/24/send';\nimport Icon24ArrowUturnLeftOutline from '@vkontakte/icons/dist/24/arrow_uturn_left_outline';\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport ReactDOM from 'react-dom'\nimport Icon16Up from '@vkontakte/icons/dist/16/up';\nimport Icon16Down from '@vkontakte/icons/dist/16/down';\nimport Icon20HomeOutline from '@vkontakte/icons/dist/20/home_outline';\nimport SERVER_URL from './Params'\nimport {FixedLayout} from '@vkontakte/vkui'\n\nclass Rating extends React.Component {\n\tconstructor(props) {\n\t\t super();\n\t\t this.N = 8;\n\t\t this.M = 20;\n\t\t this.props = props;\n\t\t this.state = {place: 0, our_place: 100000000, table: []};\n\t\t this.changePlace(0);\n\n\t\t console.log(this.props);\n\t\t this.getUserInfo = this.getUserInfo.bind(this);\n\t\t this.renderRating = this.renderRating.bind(this);\n\t\t this.getRatingTable = this.getRatingTable.bind(this);\n\t\t this.changePlace = this.changePlace.bind(this);\n\t\t this.goHome = this.goHome.bind(this);\n\t}\n\n\tasync getUserInfo() {\n\t\tlet response = await fetch(SERVER_URL + 'user?' + new URLSearchParams({token: this.props.token}));\n\t\treturn await response.json();\n\t}\n\n\tasync getRatingTable(start, end) {\n\t\tconsole.log('start ' + start + ' end ' + end);\n\t\tvar response = await fetch(SERVER_URL + 'rating?' + new URLSearchParams({'n': start, 'm': end, 'token': this.props.token}));\n\t\tvar json = await response.json();\n\t\tconsole.log('getRatingTable');\n\t\tconsole.log(json);\n\t\tfor(var i = 0; i < json.rating.length; i += 1) {\n\t\t\tjson.rating[i]['place'] = start + i + 1;\n\t\t}\n\t\tconsole.log('places..')\n\t\tconsole.log(json.rating)\n\t\treturn json.rating;\n\t}\n\n\trenderRating(place, table) {\n\t\tconsole.log('renderRating');\n\t\tconsole.log(place);\n\t\tconsole.log(table);\n\t\treturn (\n\t\t\t<CardGrid>\n\t\t\t\t{table.map(entry => {\n\t\t\t\t\treturn <Card size='l' mode={{0: \"shadow\", 1: \"tint\"}[place != entry['place']]}>\n\t\t\t\t\t\t<Div style={{\"float\": \"left\"}}>{entry['place']}е</Div>\n\t\t\t\t\t\t<Div style={{\"float\": \"left\"}}>{entry['name']}</Div>\n\t\t\t\t\t\t<Div style={{\"float\": \"right\"}}>{entry['avg_score'].toFixed(2)}</Div>\n\t\t\t\t\t</Card>}\n\t\t\t\t)}\n\t\t\t</CardGrid>\n\t\t);\n\t}\n\n\tasync changePlace(delta) {\n\t\tconsole.log('changePlace ' + delta);\n\t\tvar info = await this.getUserInfo();\n\t\tvar our_place = info['place'];\n\t\tvar place = Math.max(0, this.state.place + delta);\n\t\tvar table = await this.getRatingTable(place, place + this.N - 1);\n\t\tconsole.log('table ' + table);\n\t\tthis.setState({table: table, our_place: our_place, place: place});\n\t\tconsole.log(this)\n\t}\n\n\tasync goHome() {\n\t\tvar info = await this.getUserInfo();\n\t\tvar our_place = info.user.place;\n\t\tvar place = Math.max(0, our_place - this.N / 2);\n\t\tvar table = await this.getRatingTable(place, place + this.N - 1);\n\t\tthis.setState({table: table, our_place: our_place, place: place});\n\t\tconsole.log(this)\n\t}\n\n  render() {\n\t\tconsole.log('rating_render')\n\t\treturn (\n\t\t<Panel id={this.props.id}>\n\t\t\t\t<PanelHeader>Рейтинг</PanelHeader>\n\t\t\t\t{/*{fetchedUser &&\n\t\t\t\t<Group title=\"User Data Fetched with VK Bridge\">\n\t\t\t\t\t<Cell\n\t\t\t\t\t\tbefore={fetchedUser.photo_200 ? <Avatar src={fetchedUser.photo_200}/> : null}\n\t\t\t\t\t\tdescription={fetchedUser.city && fetchedUser.city.title ? fetchedUser.city.title : ''}\n\t\t\t\t\t>\n\t\t\t\t\t\t{`${fetchedUser.first_name} ${fetchedUser.last_name}`}\n\t\t\t\t\t</Cell>/* Chat containers </Group>}*/}\n\t\t\t\t{this.renderRating(this.state.place, this.state.table)}\n\t\t\t\t<FixedLayout vertical=\"bottom\">\n\t\t\t\t\t<Div style={{display: 'flex'}}>\n\t\t\t\t\t\t <Button size=\"l\" stretched style={{ marginRight: 8 }}\n\t\t\t\t\t\t\t\t\t\tbefore={<Icon16Up/>} onClick={() => {this.changePlace(-1)}}></Button>\n\t\t\t\t\t\t <Button size=\"l\" stretched style={{ marginRight: 8 }} mode=\"secondary\"\n\t\t\t\t\t\t\t\t\t\tbefore={<Icon20HomeOutline/>} onClick={this.goHome}>Мое место</Button>\n\t\t\t\t\t\t <Button size=\"l\" stretched style={{ marginRight: 8 }}\n\t\t\t\t\t\t\t\t\t\tbefore={<Icon16Down/>} onClick={() => {this.changePlace(1)}}></Button>\n\t\t\t\t\t</Div>\n\t\t\t\t</FixedLayout>\n\t\t\t</Panel>);\n\t\t}\n}\n\nRating.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n\tfetchedUser: PropTypes.shape({\n\t\tphoto_200: PropTypes.string,\n\t\tfirst_name: PropTypes.string,\n\t\tlast_name: PropTypes.string,\n\t\tcity: PropTypes.shape({\n\t\t\ttitle: PropTypes.string,\n\t\t}),\n\t}),\n};\n\nexport default Rating;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport List from '@vkontakte/vkui/dist/components/List/List'\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout'\nimport Textarea from '@vkontakte/vkui/dist/components/Textarea/Textarea'\nimport Card from '@vkontakte/vkui/dist/components/Card/Card'\nimport CardGrid from '@vkontakte/vkui/dist/components/CardGrid/CardGrid'\nimport Input from '@vkontakte/vkui/dist/components/Input/Input'\nimport Separator from '@vkontakte/vkui/dist/components/Separator/Separator'\nimport Alert from '@vkontakte/vkui/dist/components/Alert/Alert'\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell'\nimport Icon24Send from '@vkontakte/icons/dist/24/send';\nimport Icon24ArrowUturnLeftOutline from '@vkontakte/icons/dist/24/arrow_uturn_left_outline';\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport ReactDOM from 'react-dom'\nimport Icon16Up from '@vkontakte/icons/dist/16/up';\nimport Icon16Down from '@vkontakte/icons/dist/16/down';\nimport Icon20HomeOutline from '@vkontakte/icons/dist/20/home_outline';\nimport SERVER_URL from './Params'\nimport {FormLayoutGroup, Radio} from '@vkontakte/vkui'\n\nclass Settings extends React.Component {\n\tconstructor(props) {\n\t\t super();\n\t\t this.props = props;\n\t\t this.state = {lang: -1, hints: -1};\n\n\t\t console.log(this.props);\n\t\t this.getUserInfo = this.getUserInfo.bind(this);\n\t\t this.updateLang = this.updateLang.bind(this);\n\n\t\t this.getUserInfo().then(result => this.setState({lang: result['user']['lang'], hints: result['user']['hints']}));\n\t}\n\n\tasync getUserInfo() {\n\t\tconsole.log(\"getUserInfo\")\n\t\tlet response = await fetch(SERVER_URL + 'user?' + new URLSearchParams({token: this.props.token}));\n\t\tconsole.log(\"getUserInfo - end\");\n\t\treturn await response.json();\n\t}\n\n\tupdateLang(lang) {\n\t\t//this.setState({disabled: true})\n\t\tfetch(SERVER_URL + 'language',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t body: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': this.props.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'lang': lang\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}});\n\t\tthis.setState({lang: lang});\n\t\tconsole.log(this.state.lang);\n\t\t//this.setState({disabled: false});\n\t}\n\n\tupdateHints(hints) {\n\t\tfetch(SERVER_URL + 'hints',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t body: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': this.props.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'hints': hints\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}});\n\t\tthis.setState({hints: hints});\n\t\t//this.setState({disabled: false});\n\t}\n\n  render() {\n\t\treturn (\n\t\t<Panel id={this.props.id}>\n\t\t\t\t<PanelHeader>Настройки</PanelHeader>\n\t\t\t\t<FormLayout>\n\t\t\t\t\t<FormLayoutGroup top=\"Язык диалогов\">\n\t\t\t\t\t\t<Radio name=\"radio\" value=\"1\" description=\"Новые диалоги будут только на русском\" checked={this.state.lang == 1} onClick={() => this.updateLang(1)}>Русский</Radio>\n\t\t\t\t\t\t<Radio name=\"radio\" value=\"2\" description=\"Новые диалоги будут только на английском\" checked={this.state.lang == 2} onClick={() => this.updateLang(2)}>Английский</Radio>\n\t\t\t\t\t\t<Radio name=\"radio\" value=\"3\" description=\"Новые диалоги будут то на русском, то на английском\" checked={this.state.lang == 3} onClick={() => this.updateLang(3)}>Оба</Radio>\n\t\t\t\t\t</FormLayoutGroup>\n\n\t\t\t\t\t<FormLayoutGroup top=\"Подсказки\" bottom=\"Подсказки значительно замедляют оценку диалога.\">\n\t\t\t\t\t\t<Radio name=\"radio1\" value=\"1\" checked={this.state.hints == 1} onClick={() => this.updateHints(1)}>Включить подсказки</Radio>\n\t\t\t\t\t\t<Radio name=\"radio1\" value=\"0\" checked={this.state.hints == 0} onClick={() => this.updateHints(0)}>Отлючить подсказки</Radio>\n\t\t\t\t\t</FormLayoutGroup>\n\t\t\t\t</FormLayout>\n\t\t\t</Panel>);\n\t\t}\n}\n\nexport default Settings;\n","import React from 'react';\nimport connect from '@vkontakte/vkui-connect';\nimport { View, Epic, Tabbar, TabbarItem, Panel, PanelHeader, Spinner } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Icon28ChatsOutline from '@vkontakte/icons/dist/28/chats_outline';\nimport Icon28ListOutline from '@vkontakte/icons/dist/28/list_outline';\nimport Icon24Settings from '@vkontakte/icons/dist/24/settings';\n\nimport Home from './panels/Home';\nimport Rating from './panels/Rating';\nimport Settings from './panels/Settings';\nimport SERVER_URL from './panels/Params'\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tactivePanel: 'home',\n\t\t\tfetchedUser: null,\n\t\t\tactiveStory: 'chat',\n\t\t\ttoken: \"not-obtained\",\n\t\t};\n\t\tthis.renderHome = this.renderHome.bind(this);\n\t\tthis.renderRating = this.renderRating.bind(this);\n\t\tthis.renderSettings = this.renderSettings.bind(this);\n\t\tthis.onStoryChange = this.onStoryChange.bind(this);\n\t\tthis.parseQueryString = this.parseQueryString.bind(this);\n\t\tthis.obtainToken = this.obtainToken.bind(this);\n\t}\n\n\tparseQueryString = (string) => {\n        return string.slice(1).split('&')\n            .map((queryParam) => {\n                let kvp = queryParam.split('=');\n                return {key: kvp[0], value: kvp[1]}\n            })\n            .reduce((query, kvp) => {\n                query[kvp.key] = kvp.value;\n                return query\n            }, {})\n    };\n\n\n\tcomponentDidMount() {\n\t\tthis.obtainToken();\n\t}\n\n\tgo = (e) => {\n\t\tthis.setState({ activePanel: e.currentTarget.dataset.to })\n\t};\n\n  onStoryChange(e) {\n    this.setState({ activeStory: e.currentTarget.dataset.story });\n  }\n\n\tasync obtainToken() {\n\t\tconst urlParams = window.location.search;\n\t\tlet req_params = {'data': urlParams};\n\t\t//console.log(\"req_params \" + req_params);\n\t\treq_params = JSON.stringify(req_params);\n\t\tvar result = await fetch(SERVER_URL + 'token',\n\t\t\t\t\t{\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tbody: req_params,\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\tvar json = await result.json()\n\t\tthis.setState({token: json['token']});\n\t\tconsole.log('!!!!!!!!!!!!TOKEN!!!!!!!!!!!!!!!!');\n\t\tconsole.log(json['token']);\n\t}\n\n\trenderHome() {\n\t\tif (this.state.token != 'not-obtained') {\n\t\t\treturn <Home id=\"home\" fetchedUser={this.state.fetchedUser} go={this.go} token={this.state.token}/>\n\t\t} else {\n\t\t\treturn <Panel id=\"home\">\n\t\t\t\t\t\t<Spinner size=\"large\" style={{ marginTop: 50 }} />\n\t\t\t\t\t\t</Panel>;\n\t\t}\n\t}\n\n\trenderRating() {\n\t\tif (this.state.token != 'not-obtained') {\n\t\t\treturn <Rating id=\"rating\" fetchedUser={this.state.fetchedUser} go={this.go} token={this.state.token}/>\n\t\t} else {\n\t\t\treturn <Panel id=\"rating\"></Panel>\n\t\t}\n\t}\n\n\trenderSettings() {\n\t\tif (this.state.token != 'not-obtained') {\n\t\t\treturn <Settings id=\"settings\" fetchedUser={this.state.fetchedUser} go={this.go} token={this.state.token}/>\n\t\t} else {\n\t\t\treturn <Panel id=\"settings\"></Panel>\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Epic activeStory={this.state.activeStory} tabbar={\n        <Tabbar>\n          <TabbarItem\n            onClick={this.onStoryChange}\n            selected={this.state.activeStory === 'chat'}\n            data-story=\"chat\"\n            text=\"Чат\"\n          ><Icon28ChatsOutline /></TabbarItem>\n          <TabbarItem\n            onClick={this.onStoryChange}\n            selected={this.state.activeStory === 'rating-view'}\n            data-story=\"rating-view\"\n            text=\"Рейтинг\"\n          ><Icon28ListOutline /></TabbarItem>\n\t\t\t\t\t<TabbarItem\n            onClick={this.onStoryChange}\n            selected={this.state.activeStory === 'settings-view'}\n            data-story=\"settings-view\"\n            text=\"Настройки\"\n          ><Icon24Settings /></TabbarItem>\n\t\t\t\t</Tabbar>}>\n\t\t\t<View id=\"chat\" activePanel={this.state.activePanel}>\n\t\t\t\t{this.renderHome()}\n\t\t\t</View>\n\t\t\t<View id=\"rating-view\" activePanel=\"rating\">\n\t\t\t\t{this.renderRating()}\n\t\t\t</View>\n\t\t\t<View id=\"settings-view\" activePanel=\"settings\">\n\t\t\t\t{this.renderSettings()}\n\t\t\t</View>\n\t\t</Epic>\n\t\t);\n\t}\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vkui-connect';\nimport App from './App';\n// import registerServiceWorker from './sw';\n\n// Init VK App\nconnect.send('VKWebAppInit', {});\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT\n// registerServiceWorker();\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}