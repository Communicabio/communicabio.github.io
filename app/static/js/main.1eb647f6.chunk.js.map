{"version":3,"sources":["img/communicabio.svg","panels/Params.js","panels/Home.js","panels/Rating.js","panels/Settings.js","App.js","index.js"],"names":["module","exports","__webpack_require__","p","SERVER_URL","EndOfDialog","React","Component","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","instance","createRef","script","document","createElement","run","dialog_id","text","async","console","log","current","appendChild","scores","react_default","a","map","element","Alert_default","id","actionsLayout","actions","title","autoclose","mode","action","onClose","ref","Home","_this2","state","popout","history","disabled","token","create_alert","bind","assertThisInitialized","prepare_alert","get_reply_to","handle_send_message","rollback_dialog","remove_alert","message2Cell","onHandleFormChange","onHandleFormSubmit","get_new_dialog","get_score","get_chat_history","isTooltipClosed","closeTooltip","create_feedback_panel","renderFeedbackPanel","then","length","setState","fetch","URLSearchParams","json","formatted_list","last_dialog","user","i","push","actor","method","body","JSON","stringify","response","chat_history","localStorage","setItem","headers","Content-Type","ok","status","msg","message","result","_this3","flag","_this4","_this5","Card_default","size","forEach","item","es6","isShown","tooltip","offsetX","Cell_default","_this6","Panel_default","Div_default","renderMessage","style","height","vertical","Button_default","onClick","ind","ind2","hint_count","mistakes","metric","mistake","word","alert_element","Home_EndOfDialog","_this7","dict","score","toFixed","multiline","before","Avatar_default","src","require","e","user_message","target","value","preventDefault","array","tooltips","j","repl","PanelHeader_default","marginTop","_this8","0","1","display","stretched","marginRight","arrow_uturn_left_outline_default","cancel_default","Separator_default","position","Textarea_default","float","marginBottom","onChange","defaultValue","send_default","chatRender","loadigRender","Rating","N","M","place","our_place","table","changePlace","getUserInfo","renderRating","getRatingTable","goHome","start","end","n","m","rating","CardGrid_default","entry","delta","info","Math","max","up_default","home_outline_default","down_default","Settings","lang","hints","updateLang","FormLayout_default","top","name","description","checked","bottom","updateHints","App","parseQueryString","string","slice","split","queryParam","kvp","key","reduce","query","go","activePanel","currentTarget","dataset","to","fetchedUser","activeStory","renderHome","renderSettings","onStoryChange","obtainToken","story","urlParams","window","location","search","req_params","data","src_panels_Home","panels_Rating","panels_Settings","tabbar","selected","data-story","chats_outline_default","list_outline_default","settings_default","connect","send","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.1eb647f6.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/communicabio.e8edc935.svg\";","var SERVER_URL = \"https://communicabio-server-b7e3qu3u4a-uc.a.run.app/\";\nexport default SERVER_URL;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport List from '@vkontakte/vkui/dist/components/List/List'\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout'\nimport Textarea from '@vkontakte/vkui/dist/components/Textarea/Textarea'\nimport Card from '@vkontakte/vkui/dist/components/Card/Card'\nimport CardGrid from '@vkontakte/vkui/dist/components/CardGrid/CardGrid'\nimport Input from '@vkontakte/vkui/dist/components/Input/Input'\nimport Separator from '@vkontakte/vkui/dist/components/Separator/Separator'\nimport Alert from '@vkontakte/vkui/dist/components/Alert/Alert'\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell'\nimport Icon24Send from '@vkontakte/icons/dist/24/send';\nimport Icon24ArrowUturnLeftOutline from '@vkontakte/icons/dist/24/arrow_uturn_left_outline';\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport './Home.css'\nimport SERVER_URL from './Params'\nimport ReactDOM from 'react-dom'\nimport {FixedLayout} from '@vkontakte/vkui'\nimport { Tooltip} from '@vkontakte/vkui';\nimport { PanelSpinner, ScreenSpinner, Spinner } from '@vkontakte/vkui';\nimport { useRef, useEffect} from \"react\"\n\nvar node_before_alert = null;\n\nclass Example extends React.Component {\n\tconstructor(props) {\n\t\tsuper();\n\t}\n\n\trender() {\n\t\treturn <p>some text</p>\n\t}\n}\n\nclass EndOfDialog extends React.Component {\n\tconstructor(props) {\n\t\tsuper();\n\t\tthis.props = props;\n\t\tthis.instance = React.createRef()\n\t}\n\n\tcomponentDidMount() {\n\t\tconst script = document.createElement(\"script\"); // document.getElementById(\"vk-share\").appendChild\n\t\tvar vk_table = 'VK.Share.button({url: \"https://communicabio.github.io/share?dialog=' + this.props.dialog_id + '\"},{type: \"round_nocount\", text: \"Поделиться диалогом\"});';\n\t\tvar run = \"var htmlobj = document.createElement('div'); htmlobj.innerHTML = \" + vk_table + \";console.log(htmlobj);document.getElementById('vk-share').appendChild(htmlobj);\"\n\t\tscript.text = run\n\t\tscript.async = true;\n\t\tconsole.log(this.instance);\n\t\tconsole.log(this.instance.current);\n\t\tthis.instance.current.appendChild(script);\n\t}\n\n\trender() {\n\t\t//const instance = useRef(null);\n\t\tvar scores = this.props.scores;\n\t\tconsole.log(\"dialog scores\");\n\t\tconsole.log(scores);\n\t\tif (scores[0]['score'] < 0) {\n\t\t\t\ttext = <p>К сожалению, у нас пока нет нормальных критериев оценки на английском. Через пару дней все изменится</p>\n\t\t} else {\n\t\t\tvar text = <p>\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tscores.map(element => <p>Ваши баллы за {element['metric']}: {element['score']}<br/></p>)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t </p>\n\t\t}\n\n\t\treturn (<Alert id=\"end-of-dialog-alert\" actionsLayout=\"vertical\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t actions={[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t title: 'Продолжить',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t autoclose: true,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t mode: 'default',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t action: () => {},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t \t]}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \tonClose={() => {}}>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t<h2>Завершение диалога</h2>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{text}\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div ref={this.instance}></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div id=\"vk-share\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</Alert>);\n\t} // this.props.create_feedback_panel\n}\n\nclass Home extends React.Component {\n\tconstructor(props) {\n\t\t super();\n\t\t console.log('home-init');\n\t\t this.state = {popout: null, history: [], disabled: false, token: null};\n\t\t this.props = props\n\t\t console.log(this.props)\n\t\t this.create_alert = this.create_alert.bind(this);\n\t\t this.prepare_alert = this.prepare_alert.bind(this);\n\t\t //this.add_chat_message = this.add_chat_message.bind(this);\n\t\t this.get_reply_to = this.get_reply_to.bind(this);\n\t\t this.handle_send_message = this.handle_send_message.bind(this);\n\t \t this.rollback_dialog = this.rollback_dialog.bind(this);\n\t \t this.remove_alert = this.remove_alert.bind(this);\n\t\t this.message2Cell = this.message2Cell.bind(this);\n\t\t this.onHandleFormChange = this.onHandleFormChange.bind(this);\n\t\t this.onHandleFormSubmit = this.onHandleFormSubmit.bind(this);\n\t\t this.get_new_dialog = this.get_new_dialog.bind(this);\n\t\t this.get_score = this.get_score.bind(this);\n\t\t this.get_chat_history = this.get_chat_history.bind(this);\n\t\t this.isTooltipClosed = this.isTooltipClosed.bind(this);\n\t\t this.closeTooltip = this.closeTooltip.bind(this);\n\t\t this.create_feedback_panel = this.create_feedback_panel.bind(this);\n\t\t this.renderFeedbackPanel = this.renderFeedbackPanel.bind(this);\n\n\t \t this.get_chat_history().then(history => {\n\t\t\t if (history.length == 0) {\n\t\t\t\t this.get_new_dialog().then(history => {this.setState({history: history})});\n\t\t \t } else {\n\t\t\t\t \tthis.setState({history: history});\n\t\t\t }\n\t\t});\n\t}\n\n\tasync get_chat_history() {\n\t\tif (this.props.token === \"not-obtained\") {\n\t\t\treturn []\n\t\t}\n\t\tconsole.log('get---user ' + this.props.token)\n\t\tvar json = await fetch(SERVER_URL + 'user?' + new URLSearchParams({token: this.props.token}));\n\t\tvar formatted_list = []\n\t\tjson = await json.json();\n\t\tconsole.log(json)\n\t\tvar last_dialog = json.user.last_dialog;\n\t\tconsole.log(last_dialog);\n\t\tif (last_dialog == null) {\n\t\t\treturn [];\n\t\t}\n\t\tfor (var i = 0; i < last_dialog.length; i += 1) {\n\t\t\tformatted_list.push({'text': last_dialog[i], 'actor': i % 2})\n\t\t}\n\t\tconsole.log('last_dialog ' + formatted_list);\n\t\treturn formatted_list\n\t}\n\n\tasync get_new_dialog() {\n\t\tconsole.log(\"get_new_dialog \");\n\t\tconst token = this.props.token;\n\t\tif (token == 'not-obtained') {\n\t\t\treturn []\n\t\t}\n\t\tvar response = await fetch(SERVER_URL + 'start_dialog', {method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\tbody: JSON.stringify({'token': token})});\n\t\tvar json = await response.json();\n\t\tvar text = json['first_message']\n\t\tvar chat_history = [{'actor': 0, 'text': text}];\n\t\tlocalStorage.setItem('chat_history', JSON.stringify(chat_history));\n\t\treturn chat_history;\n\t}\n\n\tasync get_score(history) {\n\t\tconst token = this.props.token;\n\t\tvar response = await fetch(SERVER_URL + 'finish_dialog', {method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': token\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}})\n\t\tconsole.log(\"response\")\n\t\tconsole.log(response.ok)\n\t\tconsole.log(response.status)\n\t\tif (!response.ok) {\n\t\t\t\tthis.remove_alert(1);\n\t\t\t\treturn null;\n\t\t}\n\t\tvar json = await response.json();\n\t\tconsole.log('get_score ' + json)\n\t\treturn json;\n\t}\n\n\tasync get_reply_to(msg) {\n\t\tvar history = this.state.history;\n\t\thistory.push({'text': msg, 'actor': 1});\n\t\tconsole.log(history);\n\t\tthis.setState({history: history, disabled: true});\n\n\t\tfetch(\n\t\t\tSERVER_URL + 'reply',\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: JSON.stringify(\n\t\t\t\t\t{\n\t\t\t\t\t\t'token': this.props.token,\n\t\t\t\t\t\t'message': msg\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t}\n\t\t\t}\n\t\t).then(result => {\n\t\t\tthis.get_chat_history().then(\n\t\t\t\thistory => this.setState({history: history, disabled: false})\n\t\t\t);\n\t\t});\n\t\tconsole.log(this.state);\n\t}\n\n\thandle_send_message() {\n\t\treturn;\n\t\tthis.add_chat_message(this.state.user_message, 1);\n\t\tthis.get_reply_to(\"\");\n\t}\n\n \tasync rollback_dialog() {\n\t\t// send request to server\n\t\tthis.setState({disabled: true})\n\t\tvar response = await fetch(SERVER_URL + 'rollback',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t body: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': this.props.token\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}});\n\t\tvar chat_history = await this.get_chat_history();\n\t\tthis.setState({history: chat_history, disabled: false});\n\t}\n\n\tremove_alert(flag) {\n\t\tconsole.log('remove alert');\n\t\tif (flag) {\n\t\t\tthis.get_new_dialog().then(history => {this.setState({popout: null, history: history})});\n\t\t} else {\n\t\t\tthis.setState({popout: null});\n\t\t}\n\t\t//get_new_dialog().then(history => {this.setState({history: history})});\n\t}\n\n\trenderMessage(message) {\n\t\tconsole.log(\"renderMessage \" + JSON.stringify(message));\n\t\tif (message['actor'] == 0) {\n\t\t\treturn <Card mode=\"shadow\" size='l'>{this.message2Cell(message)}</Card>\n\t\t}\n\t\tif (message['mistakes'].length == 0) {\n\t\t\treturn <Card mode=\"tint\" size='l'>{this.message2Cell(message)}</Card>\n\t\t}\n\t\tconsole.log(message['mistakes']);\n\t\tvar text = \"\";\n\t\tmessage['mistakes'].forEach((item, i) => {\n\t\t\t\ttext += '«' + item['word'] + '» портит показатель «' + item['metric'] + '»\\n';\n\t\t});\n\t\tconsole.log(text);\n\t\t// this.setState({ tooltip: this.state.tooltip + 1})\n\t\tvar element =  <Tooltip\n\t\t\t\t\t\t\t\t\t\t\ttext={text}\n\t\t\t\t\t\t\t\t\t\t\tisShown={this.state.tooltip == message['ind']}\n\t\t\t\t\t\t\t \t\t\t\tonClose={() => this.setState({tooltip: this.state.tooltip + 1})}\n\t\t\t\t\t\t\t\t\t\t\toffsetX={10}\n\t\t\t\t\t \t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Cell><Card mode=\"tint\" size='l'>{this.message2Cell(message)}</Card></Cell>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\tconsole.log(element);\n\n\t\treturn element;\n\n\t}\n\n\trenderFeedbackPanel() {\n\t\treturn <Panel id={this.props.id}>\n\t\t\t\t\t\t\t\t<Div id=\"chat-parent\">\n\t\t\t\t\t\t\t\t\t\t{this.history.map(message =>\n\t\t\t\t\t\t\t\t\t\t\tthis.renderMessage(message))}\n\t\t\t\t\t\t\t\t</Div>\n\t\t\t\t\t\t\t\t<Div style={{height: \"50px\"}}></Div>\n\n\t\t\t\t\t\t\t\t<FixedLayout vertical=\"bottom\">\n\t\t\t\t\t\t\t\t\t <Button size=\"xl\" mode=\"secondary\" onClick={() => this.remove_alert(1)}>Все понятно</Button>\n\t\t\t\t\t\t\t\t</FixedLayout>\n\t\t\t\t\t</Panel>\n\n\t}\n\n\tcreate_feedback_panel() {\n\t\tvar scores = this.scores;\n\t\tvar history = this.state.history;\n\t\tconsole.log('create_feedback_panel');\n\t\tconsole.log(history);\n\t\tconsole.log(scores);\n\t\tthis.history = this.state.history;\n\t\tlet ind = 0;\n\t\tlet ind2 = 0;\n\t\tlet hint_count = 0;\n\t\tfor(var i = 0; i < this.history.length; i += 1) {\n\t\t\tconsole.log(i);\n\t\t\tif (this.history[i]['actor'] == 0) {this.history[i]['mistakes'] = []}\n\t\t\telse {\n\t\t\t\tvar mistakes = [];\n\t\t\t\tthis.history[i]['ind'] = ind2;\n\t\t\t\tscores.forEach(element => {\n\t\t\t\t\tvar metric = element['metric'];\n\t\t\t\t\telement['mistakes'].forEach(mistake => {\n\t\t\t\t\t\tif (mistake[0] === ind) {\n\t\t\t\t\t\t\tmistakes.push({'metric': metric, 'word': mistake[1]});\n\t\t\t\t\t\t\thint_count += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t\tthis.history[i]['mistakes'] = mistakes;\n\t\t\t\tind2 += mistakes.length >= 1;\n\t\t\t\tind += 1;\n\t\t\t}\n\t\t}\n\t\tconsole.log('hint_count ' + hint_count);\n\t\tif (hint_count == 0) {\n\t\t\tconsole.log('hint_count == 0')\n\t\t\tthis.remove_alert(1);\n\t\t\treturn;\n\t\t}\n\t\tthis.setState({popout: \"feedback\", tooltip: 0});\n\t}\n\n\tcreate_alert(scores, dialog_id) {\n\t\tconsole.log(\"dialog scores\");\n\t\tconsole.log(scores);\n\t\tthis.scores = scores;\n\t\tvar alert_element = <EndOfDialog scores={scores} dialog_id={dialog_id}/> //  create_feedback_panel={this.create_feedback_panel}\n\t\tthis.setState({popout: alert_element});\n\t}\n\n \tasync prepare_alert() {\n\t\tthis.setState({disabled: true, popout: \"loading\"});\n\t\tvar chat_history = await this.get_chat_history();\n\t\tthis.setState({history: chat_history});\n\t\tthis.get_score(chat_history).then((response) => {\n\t\t\tthis.setState({disabled: false})\n\t\t\tif (response === null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconsole.log(response);\n\t\t\tvar dialog_id = response['dialog']\n\t\t\tresponse = response['metrics']\n\t\t\tvar dict = [{'metric': 'вежливость', 'score': (2 + 3 * response['politeness']['score']).toFixed(2), 'mistakes': response['politeness']['mistakes']},\n\t\t\t\t\t\t\t\t\t{'metric': 'позитивность', 'score': (2  + 3 * response['positivity']['score']).toFixed(2), 'mistakes': response['positivity']['mistakes']}];\n\t\t\tthis.create_alert(dict, dialog_id);\n\t\t});\n\t}\n\n\tmessage2Cell(message) {\n\t\tif (message['actor'] == 0) {\n\t\t\treturn <Cell multiline before={<Avatar src={require(\"../img/communicabio.svg\")}/>}>\n\t\t\t\t\t\t\t\t{message['text']}\n\t\t\t\t\t\t\t</Cell>\n\t\t} else {\n\t\t\treturn <Cell multiline>{message['text']}</Cell>\n\t\t}\n\t}\n\n\tonHandleFormChange(e) {\n\t\tthis.setState({\n\t\t user_message: e.target.value\n\t });\n\t}\n\n\tonHandleFormSubmit(e) {\n\t\te.preventDefault();\n\t\tconst text = this.state.user_message;\n\t\tconsole.log(text);\n\t\tthis.get_reply_to(text);\n\t\t//this.setState({user_message: \"\"});\n\t\t//console.log('user-message: ' + this.state.user_message);\n\t}\n\n\tisTooltipClosed(i) {\n\t\tvar array = this.state.tooltips;\n\t\tfor (var j = 0; j < array.length; j += 1) {\n\t\t\tif (array[j] == i) return false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tcloseTooltip(i) {\n\t\tvar array = this.state.tooltips;\n\t\tvar repl = []\n\t\tfor (var j = 0; j < array.length; j += 1) {\n\t\t\tif (array[j] != i) repl.push(array[j]);\n\t\t}\n\t\tif (repl.length == 0) {\n\n\t\t}\n\t\tthis.setState({tooltips: repl});\n\t}\n\n\tloadigRender() {\n\t\treturn <Panel id={this.props.id}>\n \t\t\t\t\t\t<PanelHeader>Чат</PanelHeader>\n\t\t\t\t\t\t<Spinner size=\"large\" style={{ marginTop: 50 }} />\n\t\t \t\t\t\t</Panel>\n\t}\n\n\tchatRender() {\n\t\treturn <Panel id={this.props.id}>\n\t\t\t<PanelHeader>Чат</PanelHeader>\n\t\t\t<Div id=\"chat-parent\">\n\t\t\t\t\t{this.state['history'].map(message =>\n\t\t\t\t\t\t<Card mode={{0: \"shadow\", 1: \"tint\"}[message['actor']]} size='l'>\n\t\t\t\t\t\t\t{this.message2Cell(message)}\n\t\t\t\t\t\t </Card>\n\t\t\t\t\t)}\n\n\n\t\t\t</Div>\n\n\t\t\t<Div style={{height: \"130px\"}}></Div>\n\n\n\t\t\t<FixedLayout vertical=\"bottom\">\n\t\t\t\t<Div>\n\t\t\t\t\t<Div style={{display: 'flex'}}>\n\t\t       <Button size=\"l\" stretched style={{ marginRight: 8 }}\n\t\t\t\t\t \t\t\t\tbefore={<Icon24ArrowUturnLeftOutline/>} disabled={this.state.disabled} onClick={() => this.rollback_dialog(this)}>Отмена</Button>\n\t\t       <Button size=\"l\" stretched mode=\"secondary\" disabled={this.state.disabled} before={<Icon24Cancel/>} onClick={this.prepare_alert}>Закончить</Button>\n\t\t     \t</Div>\n\t\t\t\t\t<Separator/>\n\t\t\t\t\t<Div style={{'position': 'relative'}}>\n\t\t\t\t\t\t<Textarea style={{\"float\": \"left\", 'marginBottom': \"10px\", \"marginRight\": \"10px\"}} onChange={this.onHandleFormChange} defaultValue={this.state.user_message}></Textarea>\n\t\t\t\t\t\t<Button onClick={this.onHandleFormSubmit} disabled={this.state.disabled} before={<Icon24Send/>} style={{\"float\": \"left\"}}></Button>\n\t\t\t\t\t</Div>\n\t\t\t\t</Div>\n\t\t\t</FixedLayout>\n\t\t</Panel>\n\t}\n\n  render() {\n\t\tconsole.log('home-render')\n\t\tconsole.log(this.props);\n\t\t//console.log(this.state.popout == null)\n\t\t/*this.history = [{'text': \"dddgggg\", \"actor\": 1, \"mistakes\": [{\"metric\": \"m\", \"word\": \"w\"}]}];\n\t\treturn this.renderFeedbackPanel()*/\n\n\t\tif (this.state.popout == null) {\n\t\t\treturn this.chatRender();\n\t\t} else {\n\t\t\tif (this.state.popout === \"feedback\") {\n\t\t\t\treturn this.renderFeedbackPanel();\n\t\t\t}\n\t\t\tif (this.state.popout === \"loading\") {\n\t\t\t\treturn this.loadigRender();\n\t\t\t}\n\t\t\treturn this.state.popout;\n\t\t}\n\t}\n}\n\nexport default Home;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport List from '@vkontakte/vkui/dist/components/List/List'\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout'\nimport Textarea from '@vkontakte/vkui/dist/components/Textarea/Textarea'\nimport Card from '@vkontakte/vkui/dist/components/Card/Card'\nimport CardGrid from '@vkontakte/vkui/dist/components/CardGrid/CardGrid'\nimport Input from '@vkontakte/vkui/dist/components/Input/Input'\nimport Separator from '@vkontakte/vkui/dist/components/Separator/Separator'\nimport Alert from '@vkontakte/vkui/dist/components/Alert/Alert'\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell'\nimport Icon24Send from '@vkontakte/icons/dist/24/send';\nimport Icon24ArrowUturnLeftOutline from '@vkontakte/icons/dist/24/arrow_uturn_left_outline';\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport ReactDOM from 'react-dom'\nimport Icon16Up from '@vkontakte/icons/dist/16/up';\nimport Icon16Down from '@vkontakte/icons/dist/16/down';\nimport Icon20HomeOutline from '@vkontakte/icons/dist/20/home_outline';\nimport SERVER_URL from './Params'\nimport {FixedLayout} from '@vkontakte/vkui'\n\nclass Rating extends React.Component {\n\tconstructor(props) {\n\t\t super();\n\t\t this.N = 8;\n\t\t this.M = 20;\n\t\t this.props = props;\n\t\t this.state = {place: 0, our_place: 100000000, table: []};\n\t\t this.changePlace(0);\n\n\t\t console.log(this.props);\n\t\t this.getUserInfo = this.getUserInfo.bind(this);\n\t\t this.renderRating = this.renderRating.bind(this);\n\t\t this.getRatingTable = this.getRatingTable.bind(this);\n\t\t this.changePlace = this.changePlace.bind(this);\n\t\t this.goHome = this.goHome.bind(this);\n\t}\n\n\tasync getUserInfo() {\n\t\tlet response = await fetch(SERVER_URL + 'user?' + new URLSearchParams({token: this.props.token}));\n\t\treturn await response.json();\n\t}\n\n\tasync getRatingTable(start, end) {\n\t\tconsole.log('start ' + start + ' end ' + end);\n\t\tvar response = await fetch(SERVER_URL + 'rating?' + new URLSearchParams({'n': start, 'm': end, 'token': this.props.token}));\n\t\tvar json = await response.json();\n\t\tconsole.log('getRatingTable');\n\t\tconsole.log(json);\n\t\tfor(var i = 0; i < json.rating.length; i += 1) {\n\t\t\tjson.rating[i]['place'] = start + i + 1;\n\t\t}\n\t\tconsole.log('places..')\n\t\tconsole.log(json.rating)\n\t\treturn json.rating;\n\t}\n\n\trenderRating(place, table) {\n\t\tconsole.log('renderRating');\n\t\tconsole.log(place);\n\t\tconsole.log(table);\n\t\treturn (\n\t\t\t<CardGrid>\n\t\t\t\t{table.map(entry => {\n\t\t\t\t\treturn <Card size='l' mode={{0: \"shadow\", 1: \"tint\"}[place != entry['place']]}>\n\t\t\t\t\t\t<Div style={{\"float\": \"left\"}}>{entry['place']}е</Div>\n\t\t\t\t\t\t<Div style={{\"float\": \"left\"}}>{entry['name']}</Div>\n\t\t\t\t\t\t<Div style={{\"float\": \"right\"}}>{entry['avg_score'].toFixed(2)}</Div>\n\t\t\t\t\t</Card>}\n\t\t\t\t)}\n\t\t\t</CardGrid>\n\t\t);\n\t}\n\n\tasync changePlace(delta) {\n\t\tconsole.log('changePlace ' + delta);\n\t\tvar info = await this.getUserInfo();\n\t\tvar our_place = info['place'];\n\t\tvar place = Math.max(0, this.state.place + delta);\n\t\tvar table = await this.getRatingTable(place, place + this.N - 1);\n\t\tconsole.log('table ' + table);\n\t\tthis.setState({table: table, our_place: our_place, place: place});\n\t\tconsole.log(this)\n\t}\n\n\tasync goHome() {\n\t\tvar info = await this.getUserInfo();\n\t\tvar our_place = info.user.place;\n\t\tvar place = Math.max(0, our_place - this.N / 2);\n\t\tvar table = await this.getRatingTable(place, place + this.N - 1);\n\t\tthis.setState({table: table, our_place: our_place, place: place});\n\t\tconsole.log(this)\n\t}\n\n  render() {\n\t\tconsole.log('rating_render')\n\t\treturn (\n\t\t<Panel id={this.props.id}>\n\t\t\t\t<PanelHeader>Рейтинг</PanelHeader>\n\t\t\t\t{/*{fetchedUser &&\n\t\t\t\t<Group title=\"User Data Fetched with VK Bridge\">\n\t\t\t\t\t<Cell\n\t\t\t\t\t\tbefore={fetchedUser.photo_200 ? <Avatar src={fetchedUser.photo_200}/> : null}\n\t\t\t\t\t\tdescription={fetchedUser.city && fetchedUser.city.title ? fetchedUser.city.title : ''}\n\t\t\t\t\t>\n\t\t\t\t\t\t{`${fetchedUser.first_name} ${fetchedUser.last_name}`}\n\t\t\t\t\t</Cell>/* Chat containers </Group>}*/}\n\t\t\t\t{this.renderRating(this.state.place, this.state.table)}\n\t\t\t\t<FixedLayout vertical=\"bottom\">\n\t\t\t\t\t<Div style={{display: 'flex'}}>\n\t\t\t\t\t\t <Button size=\"l\" stretched style={{ marginRight: 8 }}\n\t\t\t\t\t\t\t\t\t\tbefore={<Icon16Up/>} onClick={() => {this.changePlace(-1)}}></Button>\n\t\t\t\t\t\t <Button size=\"l\" stretched style={{ marginRight: 8 }} mode=\"secondary\"\n\t\t\t\t\t\t\t\t\t\tbefore={<Icon20HomeOutline/>} onClick={this.goHome}>Мое место</Button>\n\t\t\t\t\t\t <Button size=\"l\" stretched style={{ marginRight: 8 }}\n\t\t\t\t\t\t\t\t\t\tbefore={<Icon16Down/>} onClick={() => {this.changePlace(1)}}></Button>\n\t\t\t\t\t</Div>\n\t\t\t\t</FixedLayout>\n\t\t\t</Panel>);\n\t\t}\n}\n\nRating.propTypes = {\n\tid: PropTypes.string.isRequired,\n\tgo: PropTypes.func.isRequired,\n\tfetchedUser: PropTypes.shape({\n\t\tphoto_200: PropTypes.string,\n\t\tfirst_name: PropTypes.string,\n\t\tlast_name: PropTypes.string,\n\t\tcity: PropTypes.shape({\n\t\t\ttitle: PropTypes.string,\n\t\t}),\n\t}),\n};\n\nexport default Rating;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport List from '@vkontakte/vkui/dist/components/List/List'\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout'\nimport Textarea from '@vkontakte/vkui/dist/components/Textarea/Textarea'\nimport Card from '@vkontakte/vkui/dist/components/Card/Card'\nimport CardGrid from '@vkontakte/vkui/dist/components/CardGrid/CardGrid'\nimport Input from '@vkontakte/vkui/dist/components/Input/Input'\nimport Separator from '@vkontakte/vkui/dist/components/Separator/Separator'\nimport Alert from '@vkontakte/vkui/dist/components/Alert/Alert'\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell'\nimport Icon24Send from '@vkontakte/icons/dist/24/send';\nimport Icon24ArrowUturnLeftOutline from '@vkontakte/icons/dist/24/arrow_uturn_left_outline';\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\nimport ReactDOM from 'react-dom'\nimport Icon16Up from '@vkontakte/icons/dist/16/up';\nimport Icon16Down from '@vkontakte/icons/dist/16/down';\nimport Icon20HomeOutline from '@vkontakte/icons/dist/20/home_outline';\nimport SERVER_URL from './Params'\nimport {FormLayoutGroup, Radio} from '@vkontakte/vkui'\n\nclass Settings extends React.Component {\n\tconstructor(props) {\n\t\t super();\n\t\t this.props = props;\n\t\t this.state = {lang: -1, hints: -1};\n\n\t\t console.log(this.props);\n\t\t this.getUserInfo = this.getUserInfo.bind(this);\n\t\t this.updateLang = this.updateLang.bind(this);\n\n\t\t this.getUserInfo().then(result => this.setState({lang: result['user']['lang'], hints: result['user']['hints']}));\n\t}\n\n\tasync getUserInfo() {\n\t\tconsole.log(\"getUserInfo\")\n\t\tlet response = await fetch(SERVER_URL + 'user?' + new URLSearchParams({token: this.props.token}));\n\t\tconsole.log(\"getUserInfo - end\");\n\t\treturn await response.json();\n\t}\n\n\tupdateLang(lang) {\n\t\t//this.setState({disabled: true})\n\t\tfetch(SERVER_URL + 'language',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t body: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': this.props.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'lang': lang\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}});\n\t\tthis.setState({lang: lang});\n\t\tconsole.log(this.state.lang);\n\t\t//this.setState({disabled: false});\n\t}\n\n\tupdateHints(hints) {\n\t\tfetch(SERVER_URL + 'hints',\n\t\t\t\t\t\t\t\t\t\t\t\t\t{method: 'POST',\n\t\t\t\t\t\t\t\t\t\t\t\t\t body: JSON.stringify({\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'token': this.props.token,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'hints': hints\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}});\n\t\tthis.setState({hints: hints});\n\t\t//this.setState({disabled: false});\n\t}\n\n  render() {\n\t\treturn (\n\t\t<Panel id={this.props.id}>\n\t\t\t\t<PanelHeader>Настройки</PanelHeader>\n\t\t\t\t<FormLayout>\n\t\t\t\t\t<FormLayoutGroup top=\"Язык диалогов\">\n\t\t\t\t\t\t<Radio name=\"radio\" value=\"1\" description=\"Новые диалоги будут только на русском\" checked={this.state.lang == 1} onClick={() => this.updateLang(1)}>Русский</Radio>\n\t\t\t\t\t\t<Radio name=\"radio\" value=\"2\" description=\"Новые диалоги будут только на английском\" checked={this.state.lang == 2} onClick={() => this.updateLang(2)}>Английский</Radio>\n\t\t\t\t\t\t<Radio name=\"radio\" value=\"3\" description=\"Новые диалоги будут то на русском, то на английском\" checked={this.state.lang == 3} onClick={() => this.updateLang(3)}>Оба</Radio>\n\t\t\t\t\t</FormLayoutGroup>\n\n\t\t\t\t\t<FormLayoutGroup top=\"Подсказки\" bottom=\"Подсказки значительно замедляют оценку диалога.\">\n\t\t\t\t\t\t<Radio name=\"radio1\" value=\"1\" checked={this.state.hints == 1} onClick={() => this.updateHints(1)}>Включить подсказки</Radio>\n\t\t\t\t\t\t<Radio name=\"radio1\" value=\"0\" checked={this.state.hints == 0} onClick={() => this.updateHints(0)}>Отлючить подсказки</Radio>\n\t\t\t\t\t</FormLayoutGroup>\n\t\t\t\t</FormLayout>\n\t\t\t</Panel>);\n\t\t}\n}\n\nexport default Settings;\n","import React from 'react';\nimport connect from '@vkontakte/vkui-connect';\nimport { View, Epic, Tabbar, TabbarItem, Panel, PanelHeader, Spinner } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Icon28ChatsOutline from '@vkontakte/icons/dist/28/chats_outline';\nimport Icon28ListOutline from '@vkontakte/icons/dist/28/list_outline';\nimport Icon24Settings from '@vkontakte/icons/dist/24/settings';\n\nimport Home from './panels/Home';\nimport Rating from './panels/Rating';\nimport Settings from './panels/Settings';\nimport SERVER_URL from './panels/Params'\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tactivePanel: 'home',\n\t\t\tfetchedUser: null,\n\t\t\tactiveStory: 'chat',\n\t\t\ttoken: \"not-obtained\",\n\t\t};\n\t\tthis.renderHome = this.renderHome.bind(this);\n\t\tthis.renderRating = this.renderRating.bind(this);\n\t\tthis.renderSettings = this.renderSettings.bind(this);\n\t\tthis.onStoryChange = this.onStoryChange.bind(this);\n\t\tthis.parseQueryString = this.parseQueryString.bind(this);\n\t\tthis.obtainToken = this.obtainToken.bind(this);\n\t}\n\n\tparseQueryString = (string) => {\n        return string.slice(1).split('&')\n            .map((queryParam) => {\n                let kvp = queryParam.split('=');\n                return {key: kvp[0], value: kvp[1]}\n            })\n            .reduce((query, kvp) => {\n                query[kvp.key] = kvp.value;\n                return query\n            }, {})\n    };\n\n\n\tcomponentDidMount() {\n\t\tthis.obtainToken();\n\t}\n\n\tgo = (e) => {\n\t\tthis.setState({ activePanel: e.currentTarget.dataset.to })\n\t};\n\n  onStoryChange(e) {\n    this.setState({ activeStory: e.currentTarget.dataset.story });\n  }\n\n\tasync obtainToken() {\n\t\tconst urlParams = window.location.search;\n\t\tlet req_params = {'data': urlParams};\n\t\t//console.log(\"req_params \" + req_params);\n\t\treq_params = JSON.stringify(req_params);\n\t\tvar result = await fetch(SERVER_URL + 'token',\n\t\t\t\t\t{\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\tbody: req_params,\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\tvar json = await result.json()\n\t\tthis.setState({token: json['token']});\n\t\tconsole.log('!!!!!!!!!!!!TOKEN!!!!!!!!!!!!!!!!');\n\t\tconsole.log(json['token']);\n\t}\n\n\trenderHome() {\n\t\tif (this.state.token != 'not-obtained') {\n\t\t\treturn <Home id=\"home\" fetchedUser={this.state.fetchedUser} go={this.go} token={this.state.token}/>\n\t\t} else {\n\t\t\treturn <Panel id=\"home\">\n\t\t\t\t\t\t<Spinner size=\"large\" style={{ marginTop: 50 }} />\n\t\t\t\t\t\t</Panel>;\n\t\t}\n\t}\n\n\trenderRating() {\n\t\tif (this.state.token != 'not-obtained') {\n\t\t\treturn <Rating id=\"rating\" fetchedUser={this.state.fetchedUser} go={this.go} token={this.state.token}/>\n\t\t} else {\n\t\t\treturn <Panel id=\"rating\"></Panel>\n\t\t}\n\t}\n\n\trenderSettings() {\n\t\tif (this.state.token != 'not-obtained') {\n\t\t\treturn <Settings id=\"settings\" fetchedUser={this.state.fetchedUser} go={this.go} token={this.state.token}/>\n\t\t} else {\n\t\t\treturn <Panel id=\"settings\"></Panel>\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<Epic activeStory={this.state.activeStory} tabbar={\n        <Tabbar>\n          <TabbarItem\n            onClick={this.onStoryChange}\n            selected={this.state.activeStory === 'chat'}\n            data-story=\"chat\"\n            text=\"Чат\"\n          ><Icon28ChatsOutline /></TabbarItem>\n          <TabbarItem\n            onClick={this.onStoryChange}\n            selected={this.state.activeStory === 'rating-view'}\n            data-story=\"rating-view\"\n            text=\"Рейтинг\"\n          ><Icon28ListOutline /></TabbarItem>\n\t\t\t\t\t<TabbarItem\n            onClick={this.onStoryChange}\n            selected={this.state.activeStory === 'settings-view'}\n            data-story=\"settings-view\"\n            text=\"Настройки\"\n          ><Icon24Settings /></TabbarItem>\n\t\t\t\t</Tabbar>}>\n\t\t\t<View id=\"chat\" activePanel={this.state.activePanel}>\n\t\t\t\t{this.renderHome()}\n\t\t\t</View>\n\t\t\t<View id=\"rating-view\" activePanel=\"rating\">\n\t\t\t\t{this.renderRating()}\n\t\t\t</View>\n\t\t\t<View id=\"settings-view\" activePanel=\"settings\">\n\t\t\t\t{this.renderSettings()}\n\t\t\t</View>\n\t\t</Epic>\n\t\t);\n\t}\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vkui-connect';\nimport App from './App';\n// import registerServiceWorker from './sw';\n\n// Init VK App\nconnect.send('VKWebAppInit', {});\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT\n// registerServiceWorker();\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}